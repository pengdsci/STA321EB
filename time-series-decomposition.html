<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Topic 15 Time Series Decomposition | STA 321 E-pack: Advanced Statistics</title>
  <meta name="description" content="The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="Topic 15 Time Series Decomposition | STA 321 E-pack: Advanced Statistics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Topic 15 Time Series Decomposition | STA 321 E-pack: Advanced Statistics" />
  
  <meta name="twitter:description" content="The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Cheng Peng" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="concepts-of-time-series-forecasting.html"/>
<link rel="next" href="exponential-smoothing-methods.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<center><li><a href="./"><font color = "darkred"><b>STA 321 E-Pack: Advanced Statistics</b></font></a><br><font color = "navy">Cheng Peng</font></li></center>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#why-this-e-pack"><i class="fa fa-check"></i><b>1.1</b> Why This E-Pack?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#components-statistical-reports"><i class="fa fa-check"></i><b>1.2</b> Components Statistical Reports</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a.-introduction"><i class="fa fa-check"></i>A. Introduction</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#b.-materials"><i class="fa fa-check"></i>B. Materials</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#c.-methodology"><i class="fa fa-check"></i>C. Methodology</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#d.-results-and-conclusions"><i class="fa fa-check"></i>D. Results and Conclusions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#e.-general-discussion"><i class="fa fa-check"></i>E. General Discussion</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#f.-references-if-any"><i class="fa fa-check"></i>F. References (if any)</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#g.-appendices-if-any"><i class="fa fa-check"></i>G. Appendices (if any)</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#basics-of-rstudio"><i class="fa fa-check"></i><b>1.3</b> Basics of RStudio</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#rstudio-gui"><i class="fa fa-check"></i><b>1.3.1</b> RStudio GUI</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#rmarkdown"><i class="fa fa-check"></i><b>1.3.2</b> RMarkdown</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#collaborative-platforms"><i class="fa fa-check"></i><b>1.4</b> Collaborative Platforms</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#rpubs"><i class="fa fa-check"></i><b>1.4.1</b> RPubs</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#github-repository"><i class="fa fa-check"></i><b>1.4.2</b> GitHub Repository</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#github"><i class="fa fa-check"></i><b>1.5</b> Github</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#what-is-github"><i class="fa fa-check"></i><b>1.5.1</b> What is Github?</a></li>
<li class="chapter" data-level="1.5.2" data-path="index.html"><a href="index.html#getting-started-with-github"><i class="fa fa-check"></i><b>1.5.2</b> Getting Started with GitHub</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html"><i class="fa fa-check"></i><b>2</b> Data Input and Output in R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#built-in-data"><i class="fa fa-check"></i><b>2.1</b> Built-in Data</a></li>
<li class="chapter" data-level="2.2" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#loading-external-data-sets"><i class="fa fa-check"></i><b>2.2</b> Loading External Data Sets</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#preparing-r-workspace"><i class="fa fa-check"></i><b>2.2.1</b> Preparing R Workspace</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#setting-up-working-directory"><i class="fa fa-check"></i><b>2.2.2</b> Setting-up Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#read-common-files-into-r"><i class="fa fa-check"></i><b>2.3</b> Read Common Files into R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#read-txt-files-with-read.table"><i class="fa fa-check"></i><b>2.3.1</b> Read TXT files with read.table()</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#data-values-separated-by-special-symbol"><i class="fa fa-check"></i><b>2.4</b> Data Values Separated By Special Symbol</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#importing-a-csv-into-r"><i class="fa fa-check"></i><b>2.4.1</b> Importing a CSV into R</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#import-sas-spss-and-other-data-sets-into-r"><i class="fa fa-check"></i><b>2.5</b> Import SAS, SPSS, and Other Data Sets into R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#import-spss-files-into-r"><i class="fa fa-check"></i><b>2.5.1</b> Import SPSS Files into R</a></li>
<li class="chapter" data-level="2.5.2" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#mport-stata-files-into-r"><i class="fa fa-check"></i><b>2.5.2</b> mport Stata Files into R</a></li>
<li class="chapter" data-level="2.5.3" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#import-systat-files-into-r"><i class="fa fa-check"></i><b>2.5.3</b> Import Systat Files into R</a></li>
<li class="chapter" data-level="2.5.4" data-path="data-input-and-output-in-r.html"><a href="data-input-and-output-in-r.html#import-sas-files-into-r"><i class="fa fa-check"></i><b>2.5.4</b> Import SAS Files into R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="base-r-graphical-functions.html"><a href="base-r-graphical-functions.html"><i class="fa fa-check"></i><b>3</b> Base R Graphical Functions</a>
<ul>
<li class="chapter" data-level="3.1" data-path="base-r-graphical-functions.html"><a href="base-r-graphical-functions.html#r-graphic-devices"><i class="fa fa-check"></i><b>3.1</b> R Graphic Devices</a></li>
<li class="chapter" data-level="3.2" data-path="base-r-graphical-functions.html"><a href="base-r-graphical-functions.html#plotting-with-base-graphics-plot"><i class="fa fa-check"></i><b>3.2</b> Plotting with Base Graphics: <code>plot()</code></a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="base-r-graphical-functions.html"><a href="base-r-graphical-functions.html#outer-and-inner-margins"><i class="fa fa-check"></i><b>3.2.1</b> Outer and Inner Margins</a></li>
<li class="chapter" data-level="3.2.2" data-path="base-r-graphical-functions.html"><a href="base-r-graphical-functions.html#simple-multi-panel-plots"><i class="fa fa-check"></i><b>3.2.2</b> Simple multi-panel Plots</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="base-r-graphical-functions.html"><a href="base-r-graphical-functions.html#making-our-own-colors"><i class="fa fa-check"></i><b>3.3</b> Making Our Own Colors</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html"><i class="fa fa-check"></i><b>4</b> Effective Data Preparation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#data-set-description"><i class="fa fa-check"></i><b>4.1</b> Data Set Description</a></li>
<li class="chapter" data-level="4.2" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#base-r-commands-for-data-management"><i class="fa fa-check"></i><b>4.2</b> Base R Commands for Data Management</a></li>
<li class="chapter" data-level="4.3" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#working-with-scientific-notations"><i class="fa fa-check"></i><b>4.3</b> Working with Scientific Notations</a></li>
<li class="chapter" data-level="4.4" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#the-ifelse-function"><i class="fa fa-check"></i><b>4.4</b> The <strong>ifelse()</strong> Function</a></li>
<li class="chapter" data-level="4.5" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#the-cut-function"><i class="fa fa-check"></i><b>4.5</b> The <strong>cut()</strong> Function</a></li>
<li class="chapter" data-level="4.6" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#with-and-within-functions"><i class="fa fa-check"></i><b>4.6</b> <strong>with()</strong> and <strong>within()</strong> Functions</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#the-with-function"><i class="fa fa-check"></i><b>4.6.1</b> The <strong>with()</strong> Function</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#the-merge-function---table-joins"><i class="fa fa-check"></i><b>4.7</b> The <strong>merge()</strong> Function - Table Joins</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#inner-join"><i class="fa fa-check"></i><b>4.7.1</b> Inner Join</a></li>
<li class="chapter" data-level="4.7.2" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#left-join"><i class="fa fa-check"></i><b>4.7.2</b> Left Join</a></li>
<li class="chapter" data-level="4.7.3" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#right-join"><i class="fa fa-check"></i><b>4.7.3</b> Right Join</a></li>
<li class="chapter" data-level="4.7.4" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#full-outer-join"><i class="fa fa-check"></i><b>4.7.4</b> Full (outer) Join</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#subsetting-data-frame"><i class="fa fa-check"></i><b>4.8</b> Subsetting Data Frame</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#subsetting-by-columns"><i class="fa fa-check"></i><b>4.8.1</b> Subsetting by Columns</a></li>
<li class="chapter" data-level="4.8.2" data-path="effective-data-preparation.html"><a href="effective-data-preparation.html#subsetting-by-rows"><i class="fa fa-check"></i><b>4.8.2</b> Subsetting by Rows</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html"><i class="fa fa-check"></i><b>5</b> Bootstrap Confidence Intervals</a>
<ul>
<li class="chapter" data-level="5.1" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#basic-idea-of-bootstrap-method."><i class="fa fa-check"></i><b>5.1</b> Basic Idea of Bootstrap Method.</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#random-sample-from-population"><i class="fa fa-check"></i><b>5.1.1</b> Random Sample from Population</a></li>
<li class="chapter" data-level="5.1.2" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#bootstrap-sampling-and-bootstrap-sampling-distribution"><i class="fa fa-check"></i><b>5.1.2</b> Bootstrap Sampling and Bootstrap Sampling Distribution</a></li>
<li class="chapter" data-level="5.1.3" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#relationship-between-two-estimated-sampling-distributions"><i class="fa fa-check"></i><b>5.1.3</b> Relationship between Two Estimated Sampling Distributions</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#bootstrap-confidence-intervals-1"><i class="fa fa-check"></i><b>5.2</b> Bootstrap Confidence Intervals</a></li>
<li class="chapter" data-level="5.3" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#bootstrap-confidence-interval-of-correlation-coefficient"><i class="fa fa-check"></i><b>5.3</b> Bootstrap Confidence Interval of Correlation Coefficient</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#bootstrapping-data-set"><i class="fa fa-check"></i><b>5.3.1</b> Bootstrapping Data Set</a></li>
<li class="chapter" data-level="5.3.2" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#confidence-interval-of-coefficient-correlation"><i class="fa fa-check"></i><b>5.3.2</b> Confidence Interval of Coefficient Correlation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#problem-set"><i class="fa fa-check"></i><b>5.4</b> Problem Set</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#data-set-description-1"><i class="fa fa-check"></i><b>5.4.1</b> Data Set Description</a></li>
<li class="chapter" data-level="5.4.2" data-path="bootstrap-confidence-intervals.html"><a href="bootstrap-confidence-intervals.html#problems"><i class="fa fa-check"></i><b>5.4.2</b> Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html"><i class="fa fa-check"></i><b>6</b> Bootstrapping SLR</a>
<ul>
<li class="chapter" data-level="6.1" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#data-set-and-practical-questions"><i class="fa fa-check"></i><b>6.1</b> Data Set and Practical Questions</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#data-description"><i class="fa fa-check"></i><b>6.1.1</b> Data Description</a></li>
<li class="chapter" data-level="6.1.2" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#practical-question"><i class="fa fa-check"></i><b>6.1.2</b> Practical Question</a></li>
<li class="chapter" data-level="6.1.3" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>6.1.3</b> Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#simple-linear-regression-review"><i class="fa fa-check"></i><b>6.2</b> Simple Linear Regression: Review</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#structure-and-assumptions-of-simple-linear-regression-model"><i class="fa fa-check"></i><b>6.2.1</b> Structure and Assumptions of Simple Linear Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#fitting-slr-to-data"><i class="fa fa-check"></i><b>6.3</b> Fitting SLR to Data</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#parametric-slr"><i class="fa fa-check"></i><b>6.3.1</b> Parametric SLR</a></li>
<li class="chapter" data-level="6.3.2" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#bootstrap-regression"><i class="fa fa-check"></i><b>6.3.2</b> Bootstrap Regression</a></li>
<li class="chapter" data-level="6.3.3" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#concluding-remarks"><i class="fa fa-check"></i><b>6.3.3</b> Concluding Remarks</a></li>
<li class="chapter" data-level="6.3.4" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#bootstrap-residual-method"><i class="fa fa-check"></i><b>6.3.4</b> Bootstrap Residual Method</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#data-set-selection-for-project-one"><i class="fa fa-check"></i><b>6.4</b> Data Set Selection for Project One</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#data-set-requirements"><i class="fa fa-check"></i><b>6.4.1</b> Data Set Requirements</a></li>
<li class="chapter" data-level="6.4.2" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#web-sites-with-data-sets"><i class="fa fa-check"></i><b>6.4.2</b> Web Sites with Data Sets</a></li>
<li class="chapter" data-level="6.4.3" data-path="bootstrapping-slr.html"><a href="bootstrapping-slr.html#analysis-and-writing-components"><i class="fa fa-check"></i><b>6.4.3</b> Analysis and Writing Components</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html"><i class="fa fa-check"></i><b>7</b> Multiple Linear Regression Model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#the-structure-of-mlr"><i class="fa fa-check"></i><b>7.1</b> The structure of MLR</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#assumptions-based-on-the-above-special-form."><i class="fa fa-check"></i><b>7.1.1</b> Assumptions based on the above special form.</a></li>
<li class="chapter" data-level="7.1.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#potential-violations"><i class="fa fa-check"></i><b>7.1.2</b> Potential Violations</a></li>
<li class="chapter" data-level="7.1.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#variable-types"><i class="fa fa-check"></i><b>7.1.3</b> Variable types</a></li>
<li class="chapter" data-level="7.1.4" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#dummy-and-discrete-numerical-explanatory-variables"><i class="fa fa-check"></i><b>7.1.4</b> Dummy and discrete numerical explanatory variables</a></li>
<li class="chapter" data-level="7.1.5" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#interpretation-of-regression-coefficients-1"><i class="fa fa-check"></i><b>7.1.5</b> Interpretation of Regression Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#model-building"><i class="fa fa-check"></i><b>7.2</b> Model building</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#data-structure-sample-size-and-preparation-for-mlr"><i class="fa fa-check"></i><b>7.2.1</b> Data structure, sample size, and preparation for MLR</a></li>
<li class="chapter" data-level="7.2.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#candidate-models-and-residual-diagnostics"><i class="fa fa-check"></i><b>7.2.2</b> Candidate models and residual diagnostics</a></li>
<li class="chapter" data-level="7.2.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#significant-test-goodness-of-fit-and-variable-selection"><i class="fa fa-check"></i><b>7.2.3</b> Significant test, goodness-of-fit, and Variable selection</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#case-study--factors-that-impact-the-house-sale-prices"><i class="fa fa-check"></i><b>7.3</b> Case Study -Factors That Impact the House Sale Prices</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#data-description-1"><i class="fa fa-check"></i><b>7.3.1</b> Data Description</a></li>
<li class="chapter" data-level="7.3.2" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#practical-question-1"><i class="fa fa-check"></i><b>7.3.2</b> Practical Question</a></li>
<li class="chapter" data-level="7.3.3" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#exploratory-data-analysis-1"><i class="fa fa-check"></i><b>7.3.3</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="7.3.4" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#fitting-mlr-to-data"><i class="fa fa-check"></i><b>7.3.4</b> Fitting MLR to Data</a></li>
<li class="chapter" data-level="7.3.5" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#summary-of-the-model"><i class="fa fa-check"></i><b>7.3.5</b> Summary of the model</a></li>
<li class="chapter" data-level="7.3.6" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#discussions"><i class="fa fa-check"></i><b>7.3.6</b> Discussions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="multiple-linear-regression-model.html"><a href="multiple-linear-regression-model.html#written-assignment"><i class="fa fa-check"></i><b>7.4</b> Written Assignment</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html"><i class="fa fa-check"></i><b>8</b> Bootstrapping MLR Model</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#parametric-linear-regression-model"><i class="fa fa-check"></i><b>8.1</b> Parametric Linear Regression Model</a></li>
<li class="chapter" data-level="8.2" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#bootstrap-cases-boot.c"><i class="fa fa-check"></i><b>8.2</b> Bootstrap Cases (BOOT.C)</a></li>
<li class="chapter" data-level="8.3" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#bootstrap-residuals-boot.r"><i class="fa fa-check"></i><b>8.3</b> Bootstrap Residuals (BOOT.R)</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#fitted-model"><i class="fa fa-check"></i><b>8.3.1</b> Fitted Model</a></li>
<li class="chapter" data-level="8.3.2" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#residual-bootstrap-samples"><i class="fa fa-check"></i><b>8.3.2</b> Residual Bootstrap Samples</a></li>
<li class="chapter" data-level="8.3.3" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#implementation-of-residual-bootstrap-regression"><i class="fa fa-check"></i><b>8.3.3</b> Implementation of Residual Bootstrap Regression</a></li>
<li class="chapter" data-level="8.3.4" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#combining-all-inferential-statistics"><i class="fa fa-check"></i><b>8.3.4</b> Combining All Inferential Statistics</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="bootstrapping-mlr-model.html"><a href="bootstrapping-mlr-model.html#modeling-assignment"><i class="fa fa-check"></i><b>8.4</b> Modeling Assignment</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html"><i class="fa fa-check"></i><b>9</b> Simple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="9.1" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#simple-binary-logistic-regression"><i class="fa fa-check"></i><b>9.1</b> Simple Binary Logistic Regression</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#the-model-structure"><i class="fa fa-check"></i><b>9.1.1</b> The Model Structure</a></li>
<li class="chapter" data-level="9.1.2" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#interpretation-of-regression-coefficients-2"><i class="fa fa-check"></i><b>9.1.2</b> Interpretation of Regression Coefficients</a></li>
<li class="chapter" data-level="9.1.3" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#use-of-simple-logistic-regression-model"><i class="fa fa-check"></i><b>9.1.3</b> Use of Simple Logistic Regression Model</a></li>
<li class="chapter" data-level="9.1.4" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#parameter-estimation"><i class="fa fa-check"></i><b>9.1.4</b> Parameter Estimation</a></li>
<li class="chapter" data-level="9.1.5" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#model-assumptions-and-diagnostics"><i class="fa fa-check"></i><b>9.1.5</b> Model Assumptions and Diagnostics</a></li>
<li class="chapter" data-level="9.1.6" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#concluding-remarks-1"><i class="fa fa-check"></i><b>9.1.6</b> Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#a-case-study"><i class="fa fa-check"></i><b>9.2</b> A Case Study</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#data-and-variable-descriptions"><i class="fa fa-check"></i><b>9.2.1</b> Data and Variable Descriptions</a></li>
<li class="chapter" data-level="9.2.2" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#clinical-question"><i class="fa fa-check"></i><b>9.2.2</b> Clinical Question</a></li>
<li class="chapter" data-level="9.2.3" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#building-the-simple-logistic-regression"><i class="fa fa-check"></i><b>9.2.3</b> Building the Simple Logistic Regression</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#conclusion"><i class="fa fa-check"></i><b>9.3</b> Conclusion</a></li>
<li class="chapter" data-level="9.4" data-path="simple-logistic-regression-model.html"><a href="simple-logistic-regression-model.html#analysis-assignment"><i class="fa fa-check"></i><b>9.4</b> Analysis Assignment</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html"><i class="fa fa-check"></i><b>10</b> Multiple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="10.1" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#multiple-logistic-regression-model-1"><i class="fa fa-check"></i><b>10.1</b> Multiple Logistic Regression Model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#data-requirements-sources-layout-and-cleansing"><i class="fa fa-check"></i><b>10.1.1</b> Data Requirements: Sources, Layout, and Cleansing</a></li>
<li class="chapter" data-level="10.1.2" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#issues-of-predictor-variables-and-variable-inspection-transformation"><i class="fa fa-check"></i><b>10.1.2</b> Issues of Predictor Variables and Variable Inspection-Transformation</a></li>
<li class="chapter" data-level="10.1.3" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#estimation-and-interpretation-of-regression-coefficients"><i class="fa fa-check"></i><b>10.1.3</b> Estimation and Interpretation of Regression Coefficients</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#building-blocks-for-predictive-performance"><i class="fa fa-check"></i><b>10.2</b> Building Blocks for Predictive Performance</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#understanding-the-performance-of-medical-diagnostics"><i class="fa fa-check"></i><b>10.2.1</b> Understanding the Performance of Medical Diagnostics</a></li>
<li class="chapter" data-level="10.2.2" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#performance-metrics-used-in-clinical-trials"><i class="fa fa-check"></i><b>10.2.2</b> Performance Metrics Used in Clinical Trials:</a></li>
<li class="chapter" data-level="10.2.3" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#remarks"><i class="fa fa-check"></i><b>10.2.3</b> Remarks</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#case-study"><i class="fa fa-check"></i><b>10.3</b> Case Study</a></li>
<li class="chapter" data-level="10.4" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#data-and-variable-descriptions-1"><i class="fa fa-check"></i><b>10.4</b> Data and Variable Descriptions</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#research-question"><i class="fa fa-check"></i><b>10.4.1</b> Research Question</a></li>
<li class="chapter" data-level="10.4.2" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#exploratory-analysis"><i class="fa fa-check"></i><b>10.4.2</b> Exploratory Analysis</a></li>
<li class="chapter" data-level="10.4.3" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#building-the-multiple-logistic-regression-model"><i class="fa fa-check"></i><b>10.4.3</b> Building the Multiple Logistic Regression Model</a></li>
<li class="chapter" data-level="10.4.4" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#final-model-1"><i class="fa fa-check"></i><b>10.4.4</b> Final Model</a></li>
<li class="chapter" data-level="10.4.5" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#summary-and-conclusion"><i class="fa fa-check"></i><b>10.4.5</b> Summary and Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="multiple-logistic-regression-model.html"><a href="multiple-logistic-regression-model.html#analysis-assignment-1"><i class="fa fa-check"></i><b>10.5</b> Analysis Assignment</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html"><i class="fa fa-check"></i><b>11</b> Predictive Modeling with Logistic Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#cross-validation-in-predictive-modeling"><i class="fa fa-check"></i><b>11.1</b> Cross-Validation in Predictive Modeling</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#the-logic-of-the-three-way-split"><i class="fa fa-check"></i><b>11.1.1</b> The Logic of the Three-way Split</a></li>
<li class="chapter" data-level="11.1.2" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#cross-validation-cv"><i class="fa fa-check"></i><b>11.1.2</b> Cross-validation (CV)</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#predictive-performance-measures"><i class="fa fa-check"></i><b>11.2</b> Predictive Performance Measures</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#error-based-measures"><i class="fa fa-check"></i><b>11.2.1</b> Error-based Measures</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#measuring-global-performance---roc-curve"><i class="fa fa-check"></i><b>11.3</b> Measuring Global Performance - ROC Curve</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#roc-curve"><i class="fa fa-check"></i><b>11.3.1</b> ROC Curve</a></li>
<li class="chapter" data-level="11.3.2" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#area-under-the-curve-auc"><i class="fa fa-check"></i><b>11.3.2</b> Area Under The Curve (AUC)</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#case-study---diabetes-prediction-with-logistic-regression"><i class="fa fa-check"></i><b>11.4</b> Case Study - Diabetes Prediction with Logistic Regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#data-and-variable-descriptions-2"><i class="fa fa-check"></i><b>11.4.1</b> Data and Variable Descriptions</a></li>
<li class="chapter" data-level="11.4.2" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#research-question-1"><i class="fa fa-check"></i><b>11.4.2</b> Research Question</a></li>
<li class="chapter" data-level="11.4.3" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#exploratory-analysis-1"><i class="fa fa-check"></i><b>11.4.3</b> Exploratory Analysis</a></li>
<li class="chapter" data-level="11.4.4" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#standizing-numerical-predictor-variables"><i class="fa fa-check"></i><b>11.4.4</b> Standizing Numerical Predictor Variables</a></li>
<li class="chapter" data-level="11.4.5" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#data-split---training-and-testing-data"><i class="fa fa-check"></i><b>11.4.5</b> Data Split - Training and Testing Data</a></li>
<li class="chapter" data-level="11.4.6" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#best-model-identification"><i class="fa fa-check"></i><b>11.4.6</b> Best Model Identification</a></li>
<li class="chapter" data-level="11.4.7" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#roc-analysis---global-performance"><i class="fa fa-check"></i><b>11.4.7</b> ROC Analysis - Global Performance</a></li>
<li class="chapter" data-level="11.4.8" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#summary-and-conclusion-1"><i class="fa fa-check"></i><b>11.4.8</b> Summary and Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="predictive-modeling-with-logistic-regression.html"><a href="predictive-modeling-with-logistic-regression.html#analysis-assignment-2"><i class="fa fa-check"></i><b>11.5</b> Analysis Assignment</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html"><i class="fa fa-check"></i><b>12</b> Poison Regression Modeling</a>
<ul>
<li class="chapter" data-level="12.1" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#linear-regression-models"><i class="fa fa-check"></i><b>12.1</b> Linear Regression Models</a></li>
<li class="chapter" data-level="12.2" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#binary-logistic-regression-model"><i class="fa fa-check"></i><b>12.2</b> Binary Logistic Regression Model</a></li>
<li class="chapter" data-level="12.3" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#poisson-regression-models"><i class="fa fa-check"></i><b>12.3</b> Poisson Regression Models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#assumptions-of-the-poisson-regression-model"><i class="fa fa-check"></i><b>12.3.1</b> Assumptions of the Poisson Regression Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#structure-of-poisson-regression-model-for-counts"><i class="fa fa-check"></i><b>12.3.2</b> Structure of Poisson Regression Model for Counts</a></li>
<li class="chapter" data-level="12.3.3" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#poisson-models-for-rates"><i class="fa fa-check"></i><b>12.3.3</b> Poisson Models for Rates</a></li>
<li class="chapter" data-level="12.3.4" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#estimation-of-regression-coefficients-and-goodness-of-fit"><i class="fa fa-check"></i><b>12.3.4</b> Estimation of Regression Coefficients and Goodness-of-fit</a></li>
<li class="chapter" data-level="12.3.5" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#data-set-layout"><i class="fa fa-check"></i><b>12.3.5</b> Data Set Layout</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#case-study-modeling-lung-cancer-rates-in-four-cities-of-denmark---part-i"><i class="fa fa-check"></i><b>12.4</b> Case Study: Modeling Lung Cancer Rates in Four Cities of Denmark - Part I</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#poisson-regression-on-cancer-counts"><i class="fa fa-check"></i><b>12.4.1</b> Poisson Regression on Cancer Counts</a></li>
<li class="chapter" data-level="12.4.2" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#poisson-regression-on-rates"><i class="fa fa-check"></i><b>12.4.2</b> Poisson Regression on Rates</a></li>
<li class="chapter" data-level="12.4.3" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#some-graphical-comparison"><i class="fa fa-check"></i><b>12.4.3</b> Some Graphical Comparison</a></li>
<li class="chapter" data-level="12.4.4" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#discussions-and-conclusions"><i class="fa fa-check"></i><b>12.4.4</b> Discussions and Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#concluding-remarks-2"><i class="fa fa-check"></i><b>12.5</b> Concluding Remarks</a></li>
<li class="chapter" data-level="12.6" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#analysis-assignment-3"><i class="fa fa-check"></i><b>12.6</b> Analysis Assignment</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#data-description-2"><i class="fa fa-check"></i><b>12.6.1</b> Data Description</a></li>
<li class="chapter" data-level="12.6.2" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#data-formats-and-loading"><i class="fa fa-check"></i><b>12.6.2</b> Data Formats and Loading</a></li>
<li class="chapter" data-level="12.6.3" data-path="poison-regression-modeling.html"><a href="poison-regression-modeling.html#assignment-instructions"><i class="fa fa-check"></i><b>12.6.3</b> Assignment Instructions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html"><i class="fa fa-check"></i><b>13</b> Dispersed Poisson Regression</a>
<ul>
<li class="chapter" data-level="13.1" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#residuals-of-poisson-regression"><i class="fa fa-check"></i><b>13.1</b> Residuals of Poisson Regression</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#pearson-residuals"><i class="fa fa-check"></i><b>13.1.1</b> Pearson Residuals</a></li>
<li class="chapter" data-level="13.1.2" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#deviance-residuals"><i class="fa fa-check"></i><b>13.1.2</b> Deviance Residuals</a></li>
<li class="chapter" data-level="13.1.3" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#numerical-example"><i class="fa fa-check"></i><b>13.1.3</b> Numerical Example</a></li>
<li class="chapter" data-level="13.1.4" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#goodness-of-fit"><i class="fa fa-check"></i><b>13.1.4</b> Goodness-of-fit</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#dispersion-and-dispersed-poisson-regression-model"><i class="fa fa-check"></i><b>13.2</b> Dispersion and Dispersed Poisson Regression Model</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#definition-of-dispersion"><i class="fa fa-check"></i><b>13.2.1</b> Definition of Dispersion</a></li>
<li class="chapter" data-level="13.2.2" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#quasi-poisson-regression-model"><i class="fa fa-check"></i><b>13.2.2</b> Quasi-Poisson Regression Model</a></li>
<li class="chapter" data-level="13.2.3" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#numerical-example-1"><i class="fa fa-check"></i><b>13.2.3</b> Numerical Example</a></li>
<li class="chapter" data-level="13.2.4" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#summary-and-concluding-remarks"><i class="fa fa-check"></i><b>13.2.4</b> Summary and Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#case-study-i-denmark-cities-lung-cancer-rates"><i class="fa fa-check"></i><b>13.3</b> Case Study I: Denmark Cities Lung Cancer Rates</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#introduction-1"><i class="fa fa-check"></i><b>13.3.1</b> Introduction</a></li>
<li class="chapter" data-level="13.3.2" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#poisson-regression-on-cancer-counts-1"><i class="fa fa-check"></i><b>13.3.2</b> Poisson Regression on Cancer Counts</a></li>
<li class="chapter" data-level="13.3.3" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#poisson-regression-on-rates-1"><i class="fa fa-check"></i><b>13.3.3</b> Poisson Regression on Rates</a></li>
<li class="chapter" data-level="13.3.4" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#quasi-poisson-rate-model"><i class="fa fa-check"></i><b>13.3.4</b> Quasi-Poisson Rate Model</a></li>
<li class="chapter" data-level="13.3.5" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#final-working-model"><i class="fa fa-check"></i><b>13.3.5</b> Final Working Model</a></li>
<li class="chapter" data-level="13.3.6" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#some-visual-comparisons"><i class="fa fa-check"></i><b>13.3.6</b> Some Visual Comparisons</a></li>
<li class="chapter" data-level="13.3.7" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#discussions-and-conclusions-1"><i class="fa fa-check"></i><b>13.3.7</b> Discussions and Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#case-study-ii---ph.d.-and-mentors-productivity"><i class="fa fa-check"></i><b>13.4</b> Case Study II - Ph.D. and Mentor’s Productivity</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#variable-description"><i class="fa fa-check"></i><b>13.4.1</b> Variable Description</a></li>
<li class="chapter" data-level="13.4.2" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#research-question-2"><i class="fa fa-check"></i><b>13.4.2</b> Research Question</a></li>
<li class="chapter" data-level="13.4.3" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#data-preparation-and-variable-processing"><i class="fa fa-check"></i><b>13.4.3</b> Data Preparation and Variable Processing</a></li>
<li class="chapter" data-level="13.4.4" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#poison-regression-modeling-1"><i class="fa fa-check"></i><b>13.4.4</b> Poison Regression Modeling</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#section"><i class="fa fa-check"></i><b>13.5</b> </a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#some-visual-comparisons-1"><i class="fa fa-check"></i><b>13.5.1</b> Some Visual Comparisons</a></li>
<li class="chapter" data-level="13.5.2" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#conclusions"><i class="fa fa-check"></i><b>13.5.2</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="dispersed-poisson-regression.html"><a href="dispersed-poisson-regression.html#analysis-assignment-4"><i class="fa fa-check"></i><b>13.6</b> Analysis Assignment</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html"><i class="fa fa-check"></i><b>14</b> Concepts of Time Series Forecasting</a>
<ul>
<li class="chapter" data-level="14.1" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#types-of-time-series-data"><i class="fa fa-check"></i><b>14.1</b> Types of Time Series Data</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#uncorrelated-data-constant-process-model-random-time-series"><i class="fa fa-check"></i><b>14.1.1</b> Uncorrelated data, constant process model: random time series</a></li>
<li class="chapter" data-level="14.1.2" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#autocorrelated-data"><i class="fa fa-check"></i><b>14.1.2</b> Autocorrelated data</a></li>
<li class="chapter" data-level="14.1.3" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#trend-data"><i class="fa fa-check"></i><b>14.1.3</b> Trend Data</a></li>
<li class="chapter" data-level="14.1.4" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#seasonal-data"><i class="fa fa-check"></i><b>14.1.4</b> Seasonal Data</a></li>
<li class="chapter" data-level="14.1.5" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#nonstationary-data"><i class="fa fa-check"></i><b>14.1.5</b> Nonstationary Data</a></li>
<li class="chapter" data-level="14.1.6" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#atypical-event-outliers"><i class="fa fa-check"></i><b>14.1.6</b> Atypical Event (Outliers)</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#some-technical-terms-and-baseline-forecasting-models"><i class="fa fa-check"></i><b>14.2</b> Some Technical Terms and Baseline Forecasting Models</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#some-definitions"><i class="fa fa-check"></i><b>14.2.1</b> Some Definitions</a></li>
<li class="chapter" data-level="14.2.2" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#baseline-methods"><i class="fa fa-check"></i><b>14.2.2</b> Baseline Methods</a></li>
<li class="chapter" data-level="14.2.3" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#seasonal-naive-method"><i class="fa fa-check"></i><b>14.2.3</b> Seasonal Naive Method</a></li>
<li class="chapter" data-level="14.2.4" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#drift-method"><i class="fa fa-check"></i><b>14.2.4</b> Drift Method</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#accuracy-measures-in-time-series-forecasting"><i class="fa fa-check"></i><b>14.3</b> Accuracy Measures in Time Series Forecasting</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#training-and-testing-data"><i class="fa fa-check"></i><b>14.3.1</b> Training and Testing Data</a></li>
<li class="chapter" data-level="14.3.2" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#forecasting-errors"><i class="fa fa-check"></i><b>14.3.2</b> Forecasting Errors</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#case-study-1"><i class="fa fa-check"></i><b>14.4</b> Case Study</a></li>
<li class="chapter" data-level="14.5" data-path="concepts-of-time-series-forecasting.html"><a href="concepts-of-time-series-forecasting.html#analysis-assignment-5"><i class="fa fa-check"></i><b>14.5</b> Analysis Assignment</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html"><i class="fa fa-check"></i><b>15</b> Time Series Decomposition</a>
<ul>
<li class="chapter" data-level="15.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#classical-decompositions"><i class="fa fa-check"></i><b>15.1</b> Classical Decompositions</a></li>
<li class="chapter" data-level="15.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#understanding-the-classical-decomposition-of-time-series"><i class="fa fa-check"></i><b>15.2</b> Understanding the Classical Decomposition of Time Series</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#detect-trend"><i class="fa fa-check"></i><b>15.2.1</b> Detect Trend</a></li>
<li class="chapter" data-level="15.2.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#extracting-the-seasonality"><i class="fa fa-check"></i><b>15.2.2</b> Extracting the Seasonality</a></li>
<li class="chapter" data-level="15.2.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#extracting-remainder-errors"><i class="fa fa-check"></i><b>15.2.3</b> Extracting Remainder Errors</a></li>
<li class="chapter" data-level="15.2.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#reconstruct-the-original-series-compose-new-series"><i class="fa fa-check"></i><b>15.2.4</b> Reconstruct the Original Series / Compose New Series</a></li>
<li class="chapter" data-level="15.2.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#decomposing-time-series-with-decompose"><i class="fa fa-check"></i><b>15.2.5</b> Decomposing Time Series with <strong>decompose()</strong></a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#forecasting-with-decomposing"><i class="fa fa-check"></i><b>15.3</b> Forecasting with Decomposing</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#forecasting-additive-models-with-decomposing"><i class="fa fa-check"></i><b>15.3.1</b> Forecasting Additive Models with Decomposing</a></li>
<li class="chapter" data-level="15.3.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#concepts-of-seasonal-and-trend-decomposition-using-loess-stl"><i class="fa fa-check"></i><b>15.3.2</b> Concepts of Seasonal and Trend Decomposition Using Loess (STL)</a></li>
<li class="chapter" data-level="15.3.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#forecast-with-stl-decomposing"><i class="fa fa-check"></i><b>15.3.3</b> Forecast with STL decomposing</a></li>
<li class="chapter" data-level="15.3.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#length-of-time-series"><i class="fa fa-check"></i><b>15.3.4</b> Length of Time Series</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#case-study-2"><i class="fa fa-check"></i><b>15.4</b> Case Study</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#data-description-and"><i class="fa fa-check"></i><b>15.4.1</b> Data description and</a></li>
<li class="chapter" data-level="15.4.2" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#define-time-series-object"><i class="fa fa-check"></i><b>15.4.2</b> Define time series object</a></li>
<li class="chapter" data-level="15.4.3" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#forecasting-with-decomposing-1"><i class="fa fa-check"></i><b>15.4.3</b> Forecasting with Decomposing</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="time-series-decomposition.html"><a href="time-series-decomposition.html#analysis-assignment-6"><i class="fa fa-check"></i><b>15.5</b> Analysis Assignment</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html"><i class="fa fa-check"></i><b>16</b> Exponential Smoothing Methods</a>
<ul>
<li class="chapter" data-level="16.1" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#ets-framework"><i class="fa fa-check"></i><b>16.1</b> ETS Framework</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#exponential-smoothing-methods-1"><i class="fa fa-check"></i><b>16.1.1</b> Exponential Smoothing Methods</a></li>
<li class="chapter" data-level="16.1.2" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#exponential-smoothing-models"><i class="fa fa-check"></i><b>16.1.2</b> Exponential Smoothing Models</a></li>
<li class="chapter" data-level="16.1.3" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#estimation-smoothing-parameters-in-smoothing-models"><i class="fa fa-check"></i><b>16.1.3</b> Estimation Smoothing Parameters in Smoothing Models</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#simple-exponential-smoothing"><i class="fa fa-check"></i><b>16.2</b> Simple Exponential Smoothing</a></li>
<li class="chapter" data-level="16.3" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#holts-smoothing-model-linear-additive-trend"><i class="fa fa-check"></i><b>16.3</b> Holt’s Smoothing Model: Linear (additive) Trend</a></li>
<li class="chapter" data-level="16.4" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#damped-trend-methods"><i class="fa fa-check"></i><b>16.4</b> Damped Trend Methods</a></li>
<li class="chapter" data-level="16.5" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#holt-winters-model-for-trend-and-seasonal-data"><i class="fa fa-check"></i><b>16.5</b> Holt-Winters Model for Trend and Seasonal Data</a></li>
<li class="chapter" data-level="16.6" data-path="exponential-smoothing-methods.html"><a href="exponential-smoothing-methods.html#case-study-3"><i class="fa fa-check"></i><b>16.6</b> Case study</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">STA 321 E-pack: Advanced Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-decomposition" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">Topic 15</span> Time Series Decomposition<a href="time-series-decomposition.html#time-series-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Time series decomposition is a process of splitting a time series into basic components: trend, seasonality random error. The method originated a century ago and new developments in the past few decades.</p>
<p><strong>Seasonal</strong>: Patterns that repeat for a fixed period. For example, a website might receive more visits during weekends; this would produce data with seasonality of 7 days.</p>
<p><strong>Trend</strong>: The underlying trend of the metrics. A website increasing in popularity should show a general trend that goes up.</p>
<p><strong>Random Error</strong>: Also call “noise”, “residual” or “remainder”. These are the residuals of the original time series after the seasonal and trend series are removed.</p>
<p>The objective of time series decomposition is to model the trend and seasonality and estimate the overall time series as a combination of them. A seasonally adjusted value removes the seasonal effect from a value so that trends can be seen more clearly.</p>
<p>The following two working data sets were widely used in different textbooks. We will use them to illustrate some of the concepts.</p>
<p><strong>Australian Beer Production Data</strong></p>
<p>The following data gives quarterly beer production figures in Australia from 1956 through the 2nd quarter of 2010. The beer production figure is in megalitres.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="time-series-decomposition.html#cb220-1" tabindex="-1"></a>ausbeer0<span class="ot">=</span><span class="fu">c</span>(<span class="dv">284</span>, <span class="dv">213</span>, <span class="dv">227</span>, <span class="dv">308</span>, <span class="dv">262</span>, <span class="dv">228</span>, <span class="dv">236</span>, <span class="dv">320</span>, <span class="dv">272</span>, <span class="dv">233</span>, <span class="dv">237</span>, <span class="dv">313</span>, <span class="dv">261</span>, <span class="dv">227</span>, <span class="dv">250</span>, <span class="dv">314</span>, </span>
<span id="cb220-2"><a href="time-series-decomposition.html#cb220-2" tabindex="-1"></a>          <span class="dv">286</span>, <span class="dv">227</span>, <span class="dv">260</span>, <span class="dv">311</span>, <span class="dv">295</span>, <span class="dv">233</span>, <span class="dv">257</span>, <span class="dv">339</span>, <span class="dv">279</span>, <span class="dv">250</span>, <span class="dv">270</span>, <span class="dv">346</span>, <span class="dv">294</span>, <span class="dv">255</span>, <span class="dv">278</span>, <span class="dv">363</span>, </span>
<span id="cb220-3"><a href="time-series-decomposition.html#cb220-3" tabindex="-1"></a>          <span class="dv">313</span>, <span class="dv">273</span>, <span class="dv">300</span>, <span class="dv">370</span>, <span class="dv">331</span>, <span class="dv">288</span>, <span class="dv">306</span>, <span class="dv">386</span>, <span class="dv">335</span>, <span class="dv">288</span>, <span class="dv">308</span>, <span class="dv">402</span>, <span class="dv">353</span>, <span class="dv">316</span>, <span class="dv">325</span>, <span class="dv">405</span>, </span>
<span id="cb220-4"><a href="time-series-decomposition.html#cb220-4" tabindex="-1"></a>          <span class="dv">393</span>, <span class="dv">319</span>, <span class="dv">327</span>, <span class="dv">442</span>, <span class="dv">383</span>, <span class="dv">332</span>, <span class="dv">361</span>, <span class="dv">446</span>, <span class="dv">387</span>, <span class="dv">357</span>, <span class="dv">374</span>, <span class="dv">466</span>, <span class="dv">410</span>, <span class="dv">370</span>, <span class="dv">379</span>, <span class="dv">487</span>, </span>
<span id="cb220-5"><a href="time-series-decomposition.html#cb220-5" tabindex="-1"></a>          <span class="dv">419</span>, <span class="dv">378</span>, <span class="dv">393</span>, <span class="dv">506</span>, <span class="dv">458</span>, <span class="dv">387</span>, <span class="dv">427</span>, <span class="dv">565</span>, <span class="dv">465</span>, <span class="dv">445</span>, <span class="dv">450</span>, <span class="dv">556</span>, <span class="dv">500</span>, <span class="dv">452</span>, <span class="dv">435</span>, <span class="dv">554</span>, </span>
<span id="cb220-6"><a href="time-series-decomposition.html#cb220-6" tabindex="-1"></a>          <span class="dv">510</span>, <span class="dv">433</span>, <span class="dv">453</span>, <span class="dv">548</span>, <span class="dv">486</span>, <span class="dv">453</span>, <span class="dv">457</span>, <span class="dv">566</span>, <span class="dv">515</span>, <span class="dv">464</span>, <span class="dv">431</span>, <span class="dv">588</span>, <span class="dv">503</span>, <span class="dv">443</span>, <span class="dv">448</span>, <span class="dv">555</span>, </span>
<span id="cb220-7"><a href="time-series-decomposition.html#cb220-7" tabindex="-1"></a>          <span class="dv">513</span>, <span class="dv">427</span>, <span class="dv">473</span>, <span class="dv">526</span>, <span class="dv">548</span>, <span class="dv">440</span>, <span class="dv">469</span>, <span class="dv">575</span>, <span class="dv">493</span>, <span class="dv">433</span>, <span class="dv">480</span>, <span class="dv">576</span>, <span class="dv">475</span>, <span class="dv">405</span>, <span class="dv">435</span>, <span class="dv">535</span>, </span>
<span id="cb220-8"><a href="time-series-decomposition.html#cb220-8" tabindex="-1"></a>          <span class="dv">453</span>, <span class="dv">430</span>, <span class="dv">417</span>, <span class="dv">552</span>, <span class="dv">464</span>, <span class="dv">417</span>, <span class="dv">423</span>, <span class="dv">554</span>, <span class="dv">459</span>, <span class="dv">428</span>, <span class="dv">429</span>, <span class="dv">534</span>, <span class="dv">481</span>, <span class="dv">416</span>, <span class="dv">440</span>, <span class="dv">538</span>, </span>
<span id="cb220-9"><a href="time-series-decomposition.html#cb220-9" tabindex="-1"></a>          <span class="dv">474</span>, <span class="dv">440</span>, <span class="dv">447</span>, <span class="dv">598</span>, <span class="dv">467</span>, <span class="dv">439</span>, <span class="dv">446</span>, <span class="dv">567</span>, <span class="dv">485</span>, <span class="dv">441</span>, <span class="dv">429</span>, <span class="dv">599</span>, <span class="dv">464</span>, <span class="dv">424</span>, <span class="dv">436</span>, <span class="dv">574</span>, </span>
<span id="cb220-10"><a href="time-series-decomposition.html#cb220-10" tabindex="-1"></a>          <span class="dv">443</span>, <span class="dv">410</span>, <span class="dv">420</span>, <span class="dv">532</span>, <span class="dv">433</span>, <span class="dv">421</span>, <span class="dv">410</span>, <span class="dv">512</span>, <span class="dv">449</span>, <span class="dv">381</span>, <span class="dv">423</span>, <span class="dv">531</span>, <span class="dv">426</span>, <span class="dv">408</span>, <span class="dv">416</span>, <span class="dv">520</span>, </span>
<span id="cb220-11"><a href="time-series-decomposition.html#cb220-11" tabindex="-1"></a>          <span class="dv">409</span>, <span class="dv">398</span>, <span class="dv">398</span>, <span class="dv">507</span>, <span class="dv">432</span>, <span class="dv">398</span>, <span class="dv">406</span>, <span class="dv">526</span>, <span class="dv">428</span>, <span class="dv">397</span>, <span class="dv">403</span>, <span class="dv">517</span>, <span class="dv">435</span>, <span class="dv">383</span>, <span class="dv">424</span>, <span class="dv">521</span>, </span>
<span id="cb220-12"><a href="time-series-decomposition.html#cb220-12" tabindex="-1"></a>          <span class="dv">421</span>, <span class="dv">402</span>, <span class="dv">414</span>, <span class="dv">500</span>, <span class="dv">451</span>, <span class="dv">380</span>, <span class="dv">416</span>, <span class="dv">492</span>, <span class="dv">428</span>, <span class="dv">408</span>, <span class="dv">406</span>, <span class="dv">506</span>, <span class="dv">435</span>, <span class="dv">380</span>, <span class="dv">421</span>, <span class="dv">490</span>, </span>
<span id="cb220-13"><a href="time-series-decomposition.html#cb220-13" tabindex="-1"></a>          <span class="dv">435</span>, <span class="dv">390</span>, <span class="dv">412</span>, <span class="dv">454</span>, <span class="dv">416</span>, <span class="dv">403</span>, <span class="dv">408</span>, <span class="dv">482</span>, <span class="dv">438</span>, <span class="dv">386</span>, <span class="dv">405</span>, <span class="dv">491</span>, <span class="dv">427</span>, <span class="dv">383</span>, <span class="dv">394</span>, <span class="dv">473</span>, </span>
<span id="cb220-14"><a href="time-series-decomposition.html#cb220-14" tabindex="-1"></a>          <span class="dv">420</span>, <span class="dv">390</span>, <span class="dv">410</span>)</span></code></pre></div>
<ul>
<li><strong>Airline Passengers Data</strong></li>
</ul>
<p>This data set records monthly totals of international airline passengers (1949-1960).</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="time-series-decomposition.html#cb221-1" tabindex="-1"></a>AirPassengers0<span class="ot">=</span><span class="fu">c</span>(<span class="dv">112</span>, <span class="dv">118</span>, <span class="dv">132</span>, <span class="dv">129</span>, <span class="dv">121</span>, <span class="dv">135</span>, <span class="dv">148</span>, <span class="dv">148</span>, <span class="dv">136</span>, <span class="dv">119</span>, <span class="dv">104</span>, <span class="dv">118</span>, <span class="dv">115</span>, <span class="dv">126</span>, <span class="dv">141</span>, </span>
<span id="cb221-2"><a href="time-series-decomposition.html#cb221-2" tabindex="-1"></a>                <span class="dv">135</span>, <span class="dv">125</span>, <span class="dv">149</span>, <span class="dv">170</span>, <span class="dv">170</span>, <span class="dv">158</span>, <span class="dv">133</span>, <span class="dv">114</span>, <span class="dv">140</span>, <span class="dv">145</span>, <span class="dv">150</span>, <span class="dv">178</span>, <span class="dv">163</span>, <span class="dv">172</span>, <span class="dv">178</span>, </span>
<span id="cb221-3"><a href="time-series-decomposition.html#cb221-3" tabindex="-1"></a>                <span class="dv">199</span>, <span class="dv">199</span>, <span class="dv">184</span>, <span class="dv">162</span>, <span class="dv">146</span>, <span class="dv">166</span>, <span class="dv">171</span>, <span class="dv">180</span>, <span class="dv">193</span>, <span class="dv">181</span>, <span class="dv">183</span>, <span class="dv">218</span>, <span class="dv">230</span>, <span class="dv">242</span>, <span class="dv">209</span>, </span>
<span id="cb221-4"><a href="time-series-decomposition.html#cb221-4" tabindex="-1"></a>                <span class="dv">191</span>, <span class="dv">172</span>, <span class="dv">194</span>, <span class="dv">196</span>, <span class="dv">196</span>, <span class="dv">236</span>, <span class="dv">235</span>, <span class="dv">229</span>, <span class="dv">243</span>, <span class="dv">264</span>, <span class="dv">272</span>, <span class="dv">237</span>, <span class="dv">211</span>, <span class="dv">180</span>, <span class="dv">201</span>, </span>
<span id="cb221-5"><a href="time-series-decomposition.html#cb221-5" tabindex="-1"></a>                <span class="dv">204</span>, <span class="dv">188</span>, <span class="dv">235</span>, <span class="dv">227</span>, <span class="dv">234</span>, <span class="dv">264</span>, <span class="dv">302</span>, <span class="dv">293</span>, <span class="dv">259</span>, <span class="dv">229</span>, <span class="dv">203</span>, <span class="dv">229</span>, <span class="dv">242</span>, <span class="dv">233</span>, <span class="dv">267</span>, </span>
<span id="cb221-6"><a href="time-series-decomposition.html#cb221-6" tabindex="-1"></a>                <span class="dv">269</span>, <span class="dv">270</span>, <span class="dv">315</span>, <span class="dv">364</span>, <span class="dv">347</span>, <span class="dv">312</span>, <span class="dv">274</span>, <span class="dv">237</span>, <span class="dv">278</span>, <span class="dv">284</span>, <span class="dv">277</span>, <span class="dv">317</span>, <span class="dv">313</span>, <span class="dv">318</span>, <span class="dv">374</span>, </span>
<span id="cb221-7"><a href="time-series-decomposition.html#cb221-7" tabindex="-1"></a>                <span class="dv">413</span>, <span class="dv">405</span>, <span class="dv">355</span>, <span class="dv">306</span>, <span class="dv">271</span>, <span class="dv">306</span>, <span class="dv">315</span>, <span class="dv">301</span>, <span class="dv">356</span>, <span class="dv">348</span>, <span class="dv">355</span>, <span class="dv">422</span>, <span class="dv">465</span>, <span class="dv">467</span>, <span class="dv">404</span>, </span>
<span id="cb221-8"><a href="time-series-decomposition.html#cb221-8" tabindex="-1"></a>                <span class="dv">347</span>, <span class="dv">305</span>, <span class="dv">336</span>, <span class="dv">340</span>, <span class="dv">318</span>, <span class="dv">362</span>, <span class="dv">348</span>, <span class="dv">363</span>, <span class="dv">435</span>, <span class="dv">491</span>, <span class="dv">505</span>, <span class="dv">404</span>, <span class="dv">359</span>, <span class="dv">310</span>, <span class="dv">337</span>, </span>
<span id="cb221-9"><a href="time-series-decomposition.html#cb221-9" tabindex="-1"></a>                <span class="dv">360</span>, <span class="dv">342</span>, <span class="dv">406</span>, <span class="dv">396</span>, <span class="dv">420</span>, <span class="dv">472</span>, <span class="dv">548</span>, <span class="dv">559</span>, <span class="dv">463</span>, <span class="dv">407</span>, <span class="dv">362</span>, <span class="dv">405</span>, <span class="dv">417</span>, <span class="dv">391</span>, <span class="dv">419</span>,</span>
<span id="cb221-10"><a href="time-series-decomposition.html#cb221-10" tabindex="-1"></a>                <span class="dv">461</span>, <span class="dv">472</span>, <span class="dv">535</span>, <span class="dv">622</span>, <span class="dv">606</span>, <span class="dv">508</span>, <span class="dv">461</span>, <span class="dv">390</span>, <span class="dv">432</span>)</span></code></pre></div>
<div id="classical-decompositions" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Classical Decompositions<a href="time-series-decomposition.html#classical-decompositions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Classical decomposition was developed about a century ago and is still widely used nowadays. Depending on the types of time series models, there are two basic methods of decomposition: additive and multiplicative.</p>
<p>The following two time series represent the above two basic types of times series models.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="time-series-decomposition.html#cb222-1" tabindex="-1"></a>ausbeer.ts <span class="ot">=</span> <span class="fu">ts</span>(ausbeer0[<span class="dv">9</span><span class="sc">:</span><span class="dv">72</span>], <span class="at">frequency =</span> <span class="dv">4</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1958</span>, <span class="dv">1</span>))</span>
<span id="cb222-2"><a href="time-series-decomposition.html#cb222-2" tabindex="-1"></a>AirPassengers.ts <span class="ot">=</span> <span class="fu">ts</span>(AirPassengers0, <span class="at">frequency =</span> <span class="dv">4</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">1949</span>, <span class="dv">1</span>))</span>
<span id="cb222-3"><a href="time-series-decomposition.html#cb222-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb222-4"><a href="time-series-decomposition.html#cb222-4" tabindex="-1"></a><span class="fu">plot</span>(ausbeer.ts, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Additive Model&quot;</span>)</span>
<span id="cb222-5"><a href="time-series-decomposition.html#cb222-5" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers.ts, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Multiplicative Model&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-199"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-199-1.png" alt="time series plots of additive and multiplicative series" width="576" />
<p class="caption">
Figure 15.1: time series plots of additive and multiplicative series
</p>
</div>
<p>Denote <span class="math inline">\(T = trend\)</span>, <span class="math inline">\(S = seasonality\)</span>, and <span class="math inline">\(E = error\)</span>. With these notations, we can characterize the structure of <strong>additive and multiplicative</strong> time series.</p>
<p>In a <strong>multiplicative time series</strong>, the components multiply together to make the time series. As the time series increases in magnitude, the <strong>seasonal variation</strong> increases as well. The structure of a multiple time series has the following form.</p>
<p><span class="math display">\[
y_t = T_t \times S_t \times E_t.
\]</span></p>
<p>In an <strong>additive time series</strong>, the components add together to make the time series. If you have an increasing trend, you still see roughly the same size peaks and troughs throughout the time series. This is often seen in indexed time series where the absolute value is growing but changes stay relative. The structure of an additive time series has the following form</p>
<p><span class="math display">\[
y_t = T_t + S_t + E_t.
\]</span></p>
<p>For an <strong>additive time series</strong>, the detrended additive series has for <span class="math inline">\(D_t = y_t - T_t\)</span>. For the multiplicative time series, the detrended time series is calculated by <span class="math inline">\(D_t = y_t/T_t\)</span></p>
</div>
<div id="understanding-the-classical-decomposition-of-time-series" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Understanding the Classical Decomposition of Time Series<a href="time-series-decomposition.html#understanding-the-classical-decomposition-of-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To understand the structure of additive and multiplication ties series, we decompose these time series by calculating the trend, seasonality, and errors <em>manually</em> by writing a basic R script to gain a technical understanding of decomposing a time series. At the very end of this section, we introduce the R function <strong>decompose()</strong> to extract the three components of additive and multiplicative time series.</p>
<div id="detect-trend" class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Detect Trend<a href="time-series-decomposition.html#detect-trend" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To detect the underlying trend, we use a smoothing technique called <strong>moving average</strong> and it’s variant <strong>centered moving average</strong>. For a seasonal time series, the width of the moving window must be the same as the seasonality. Therefore, to decompose a time series we need to know the seasonality period: weekly, monthly, etc.</p>
<p><strong>Example 1</strong>: Australian beer production data has an annual seasonality. Since the data set is quarterly data, the moving average window should be 4.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="time-series-decomposition.html#cb223-1" tabindex="-1"></a>trend.beer <span class="ot">=</span> <span class="fu">ma</span>(ausbeer.ts, <span class="at">order =</span> <span class="dv">4</span>, <span class="at">centre =</span> T)  <span class="co"># centre = T =&gt; centered moving average</span></span>
<span id="cb223-2"><a href="time-series-decomposition.html#cb223-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb223-3"><a href="time-series-decomposition.html#cb223-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.ts</span>(ausbeer.ts), <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">lwd =</span><span class="dv">2</span>)</span>
<span id="cb223-4"><a href="time-series-decomposition.html#cb223-4" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;Extract trend from Australia Beer Production&quot;</span>)</span>
<span id="cb223-5"><a href="time-series-decomposition.html#cb223-5" tabindex="-1"></a><span class="fu">lines</span>(trend.beer, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb223-6"><a href="time-series-decomposition.html#cb223-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;original series&quot;</span>, <span class="st">&quot;trend curve&quot;</span>), <span class="at">lwd=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb223-7"><a href="time-series-decomposition.html#cb223-7" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-200"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-200-1.png" alt="Serires plot with trend curve" width="576" />
<p class="caption">
Figure 15.2: Serires plot with trend curve
</p>
</div>
<p><strong>Example 2</strong>: The airline passenger data were recorded monthly. It has an annual seasonal pattern. We choose a moving average window of 12 to extract the trend from this multiplicative time series.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="time-series-decomposition.html#cb224-1" tabindex="-1"></a>trend.air <span class="ot">=</span> <span class="fu">ma</span>(AirPassengers.ts, <span class="at">order =</span> <span class="dv">12</span>, <span class="at">centre =</span> T)  <span class="co"># centre = T =&gt; centered moving average</span></span>
<span id="cb224-2"><a href="time-series-decomposition.html#cb224-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb224-3"><a href="time-series-decomposition.html#cb224-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.ts</span>(AirPassengers.ts), <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;&quot;</span>, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">lwd =</span><span class="dv">2</span>)</span>
<span id="cb224-4"><a href="time-series-decomposition.html#cb224-4" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">&quot;Extract trend from Airline Passengers Monthly Data&quot;</span>)</span>
<span id="cb224-5"><a href="time-series-decomposition.html#cb224-5" tabindex="-1"></a><span class="fu">lines</span>(trend.air, <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb224-6"><a href="time-series-decomposition.html#cb224-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;original series&quot;</span>, <span class="st">&quot;trend curve&quot;</span>), <span class="at">lwd=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">2</span>),</span>
<span id="cb224-7"><a href="time-series-decomposition.html#cb224-7" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-201"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-201-1.png" alt="series plot with curve trend" width="576" />
<p class="caption">
Figure 15.3: series plot with curve trend
</p>
</div>
<p>The <strong>moving averages</strong> of both time series are recorded in the above two code chunks and will be used to restore the original series.</p>
<p>The process of removing the trend from a time series is called <strong>detrending</strong> time series.</p>
<p>The way of detrending a time series is dependent on the types of the time series. The following code shows how to calculate the detrended time series.</p>
<p><strong>Example 3</strong>: We calculate the detrended series using the Australian Beer data and the Airline Passengers data as an example.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="time-series-decomposition.html#cb225-1" tabindex="-1"></a>detrend.beer <span class="ot">=</span> ausbeer.ts <span class="sc">-</span> trend.beer</span>
<span id="cb225-2"><a href="time-series-decomposition.html#cb225-2" tabindex="-1"></a>detrend.air <span class="ot">=</span> AirPassengers.ts<span class="sc">/</span>trend.air</span>
<span id="cb225-3"><a href="time-series-decomposition.html#cb225-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb225-4"><a href="time-series-decomposition.html#cb225-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb225-5"><a href="time-series-decomposition.html#cb225-5" tabindex="-1"></a><span class="co"># plot(ausbeer.ts, xlab=&quot;&quot;, main = &quot;Australia Beer&quot;, col=&quot;darkred&quot;)</span></span>
<span id="cb225-6"><a href="time-series-decomposition.html#cb225-6" tabindex="-1"></a><span class="co"># plot(AirPassengers.ts, xlab=&quot;&quot;, main = &quot;Air Passengers&quot;, col=&quot;blue&quot;)</span></span>
<span id="cb225-7"><a href="time-series-decomposition.html#cb225-7" tabindex="-1"></a><span class="fu">plot</span>(detrend.beer, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Australia Beer&quot;</span>, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb225-8"><a href="time-series-decomposition.html#cb225-8" tabindex="-1"></a><span class="fu">plot</span>(detrend.air, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Air Passengers&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-202"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-202-1.png" alt="Detrended series" width="480" />
<p class="caption">
Figure 15.4: Detrended series
</p>
</div>
<p>The technique we used in removing the trend from a time series model is a non-parametric smoothing procedure. There are different techniques in statistics to estimate a curve for a given set. The <strong>moving average</strong> is one of the simplest ones and is widely used in time series.</p>
</div>
<div id="extracting-the-seasonality" class="section level3 hasAnchor" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> Extracting the Seasonality<a href="time-series-decomposition.html#extracting-the-seasonality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Similar to the trend in a time series, the seasonality of a time series is also a non-random structural pattern. We can extract the seasonality from the detrended time series.</p>
<p>The idea is to redefine a <strong>seasonal series</strong> based on the detrended series by replacing all observations taken from the same seasonal period with the average of these observations. This process is called <strong>averaging seasonality</strong>. This idea is implemented in R. Here is how to do it in R.</p>
<p><strong>Example 4</strong>: Use the <strong>Australian Beer Production Data</strong> and the <strong>Airline Passenger Data</strong> after their trends were removed. The following code illustrates how to calculate and graph the seasonality of both series.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="time-series-decomposition.html#cb226-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb226-2"><a href="time-series-decomposition.html#cb226-2" tabindex="-1"></a><span class="do">## Australia Beer</span></span>
<span id="cb226-3"><a href="time-series-decomposition.html#cb226-3" tabindex="-1"></a>mtrx.beer <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="at">data =</span> detrend.beer, <span class="at">nrow =</span> <span class="dv">4</span>))</span>
<span id="cb226-4"><a href="time-series-decomposition.html#cb226-4" tabindex="-1"></a>seasonal.beer <span class="ot">=</span> <span class="fu">colMeans</span>(mtrx.beer, <span class="at">na.rm =</span> T)</span>
<span id="cb226-5"><a href="time-series-decomposition.html#cb226-5" tabindex="-1"></a>seasonal.beer.ts <span class="ot">=</span> <span class="fu">as.ts</span>(<span class="fu">rep</span>(seasonal.beer,<span class="dv">16</span>))</span>
<span id="cb226-6"><a href="time-series-decomposition.html#cb226-6" tabindex="-1"></a><span class="fu">plot</span>(seasonal.beer.ts, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">main=</span><span class="st">&quot;Seasonal series of Australia beer&quot;</span>)</span>
<span id="cb226-7"><a href="time-series-decomposition.html#cb226-7" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb226-8"><a href="time-series-decomposition.html#cb226-8" tabindex="-1"></a>mtrx.air <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">matrix</span>(<span class="at">data =</span> detrend.air, <span class="at">nrow =</span> <span class="dv">12</span>))</span>
<span id="cb226-9"><a href="time-series-decomposition.html#cb226-9" tabindex="-1"></a>seasonal.air <span class="ot">=</span> <span class="fu">colMeans</span>(mtrx.air, <span class="at">na.rm =</span> T)</span>
<span id="cb226-10"><a href="time-series-decomposition.html#cb226-10" tabindex="-1"></a>seasonal.air.ts <span class="ot">=</span> <span class="fu">as.ts</span>(<span class="fu">rep</span>(seasonal.air,<span class="dv">16</span>))</span>
<span id="cb226-11"><a href="time-series-decomposition.html#cb226-11" tabindex="-1"></a><span class="fu">plot</span>(seasonal.air.ts, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Seasonal series of air passengers&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-203"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-203-1.png" alt="Seasonal series" width="480" />
<p class="caption">
Figure 15.5: Seasonal series
</p>
</div>
</div>
<div id="extracting-remainder-errors" class="section level3 hasAnchor" number="15.2.3">
<h3><span class="header-section-number">15.2.3</span> Extracting Remainder Errors<a href="time-series-decomposition.html#extracting-remainder-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <strong>error term</strong> is the random component in the time series. We learned the of extracting the trend and seasonality from the original time series. How to extract the “random” noise from a given time series?</p>
<p>In the additive model, the random <strong>error term</strong> is given by <span class="math inline">\(E_t = y_t - T_t -S_t\)</span>. The <strong>random error</strong> for a multiplicative model is given by <span class="math inline">\(E_t = y_t/(T_t \times S_t)\)</span>.</p>
<p><strong>Example 5</strong>: Use the above formulas to separate the random error components in additive and multiplicative models using Australian beer production and Airline passenger series data.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="time-series-decomposition.html#cb227-1" tabindex="-1"></a>random.beer <span class="ot">=</span> ausbeer.ts <span class="sc">-</span> trend.beer <span class="sc">-</span> seasonal.beer</span>
<span id="cb227-2"><a href="time-series-decomposition.html#cb227-2" tabindex="-1"></a>random.air <span class="ot">=</span> AirPassengers.ts <span class="sc">/</span> (trend.air <span class="sc">*</span> seasonal.air)</span>
<span id="cb227-3"><a href="time-series-decomposition.html#cb227-3" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb227-4"><a href="time-series-decomposition.html#cb227-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb227-5"><a href="time-series-decomposition.html#cb227-5" tabindex="-1"></a><span class="fu">plot</span>(random.beer , <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">main=</span><span class="st">&quot;Random errors of Australia beer&quot;</span>)</span>
<span id="cb227-6"><a href="time-series-decomposition.html#cb227-6" tabindex="-1"></a><span class="fu">plot</span>(random.air, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">main=</span><span class="st">&quot;Random errors of air passengers&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-204"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-204-1.png" alt="Random error components" width="480" />
<p class="caption">
Figure 15.6: Random error components
</p>
</div>
</div>
<div id="reconstruct-the-original-series-compose-new-series" class="section level3 hasAnchor" number="15.2.4">
<h3><span class="header-section-number">15.2.4</span> Reconstruct the Original Series / Compose New Series<a href="time-series-decomposition.html#reconstruct-the-original-series-compose-new-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The original series can be <strong>reconstructed</strong> by using the decomposed components. Since the <strong>moving average technique</strong> was used in the detrending series, the resulting <strong>reconstructed</strong> series with <span class="math inline">\(T_t\)</span>, <span class="math inline">\(S_t\)</span>, and <span class="math inline">\(E_t\)</span> will generate a few missing values in the beginning and the end depending on the width of the <strong>moving average window</strong>.</p>
<p><strong>Example 6</strong>: <strong>Reconstruct</strong> the <strong>original</strong> series of Australian beer data and the airline passenger data.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="time-series-decomposition.html#cb228-1" tabindex="-1"></a>recomposed.beer <span class="ot">=</span> trend.beer<span class="sc">+</span>seasonal.beer<span class="sc">+</span>random.beer</span>
<span id="cb228-2"><a href="time-series-decomposition.html#cb228-2" tabindex="-1"></a>recomposed.air <span class="ot">=</span> trend.air<span class="sc">*</span>seasonal.air<span class="sc">*</span>random.air</span>
<span id="cb228-3"><a href="time-series-decomposition.html#cb228-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb228-4"><a href="time-series-decomposition.html#cb228-4" tabindex="-1"></a><span class="fu">plot</span>(ausbeer.ts, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb228-5"><a href="time-series-decomposition.html#cb228-5" tabindex="-1"></a><span class="fu">lines</span>(recomposed.beer, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb228-6"><a href="time-series-decomposition.html#cb228-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;original series&quot;</span>, <span class="st">&quot;reconstructed series&quot;</span>), </span>
<span id="cb228-7"><a href="time-series-decomposition.html#cb228-7" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb228-8"><a href="time-series-decomposition.html#cb228-8" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;Australian Beer&quot;</span>)</span>
<span id="cb228-9"><a href="time-series-decomposition.html#cb228-9" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb228-10"><a href="time-series-decomposition.html#cb228-10" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers.ts, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb228-11"><a href="time-series-decomposition.html#cb228-11" tabindex="-1"></a><span class="fu">lines</span>(recomposed.air, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb228-12"><a href="time-series-decomposition.html#cb228-12" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;original series&quot;</span>, <span class="st">&quot;reconstructed series&quot;</span>), </span>
<span id="cb228-13"><a href="time-series-decomposition.html#cb228-13" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">lty=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">cex=</span><span class="fl">0.8</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb228-14"><a href="time-series-decomposition.html#cb228-14" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main=</span><span class="st">&quot;Airline Passengers&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-205"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-205-1.png" alt="Adding trend series to the original series" width="576" />
<p class="caption">
Figure 15.7: Adding trend series to the original series
</p>
</div>
</div>
<div id="decomposing-time-series-with-decompose" class="section level3 hasAnchor" number="15.2.5">
<h3><span class="header-section-number">15.2.5</span> Decomposing Time Series with <strong>decompose()</strong><a href="time-series-decomposition.html#decomposing-time-series-with-decompose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The R library <strong>forecast</strong> was created by a team led by a leading expert in the discipline. We’ll use the R function <strong>decompose( )</strong> in library{forecast} as a decomposition function to decompose a series into seasonal, trend, and random components. The Australian beer production (additive) and airline passenger numbers (multiplicative) will still be used to illustrate the steps.</p>
<p><strong>Example 6</strong>: Plot the components of the Australian beer production data.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="time-series-decomposition.html#cb229-1" tabindex="-1"></a>decomp.beer <span class="ot">=</span> <span class="fu">decompose</span>(ausbeer.ts, <span class="st">&quot;additive&quot;</span>)</span>
<span id="cb229-2"><a href="time-series-decomposition.html#cb229-2" tabindex="-1"></a><span class="do">## plot the decomposed components</span></span>
<span id="cb229-3"><a href="time-series-decomposition.html#cb229-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb229-4"><a href="time-series-decomposition.html#cb229-4" tabindex="-1"></a><span class="fu">plot</span>(decomp.beer, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="STA321EB_files/figure-html/unnamed-chunk-206-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><strong>Example 7</strong>: Plot the components of the Airline Passenger Data.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="time-series-decomposition.html#cb230-1" tabindex="-1"></a>decomp.air <span class="ot">=</span> <span class="fu">decompose</span>(AirPassengers.ts, <span class="st">&quot;multiplicative&quot;</span>)</span>
<span id="cb230-2"><a href="time-series-decomposition.html#cb230-2" tabindex="-1"></a><span class="do">## plot the decomposed components</span></span>
<span id="cb230-3"><a href="time-series-decomposition.html#cb230-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="at">oma=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>))</span>
<span id="cb230-4"><a href="time-series-decomposition.html#cb230-4" tabindex="-1"></a><span class="fu">plot</span>(decomp.air, <span class="at">col=</span> <span class="st">&quot;navy&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="STA321EB_files/figure-html/unnamed-chunk-207-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Th R function <strong>decompose()</strong> can be used to extract the individual components from a given additive and multiplicative model using the following code.</p>
<p><strong>Example 8</strong>: Decomposing Australian beer production data using <strong>decompose()</strong>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="time-series-decomposition.html#cb231-1" tabindex="-1"></a>decomp.beer <span class="ot">=</span> <span class="fu">decompose</span>(ausbeer.ts, <span class="st">&quot;additive&quot;</span>)</span>
<span id="cb231-2"><a href="time-series-decomposition.html#cb231-2" tabindex="-1"></a><span class="co"># the four components can be extracted by</span></span>
<span id="cb231-3"><a href="time-series-decomposition.html#cb231-3" tabindex="-1"></a>seasonal.beer <span class="ot">=</span> decomp.beer<span class="sc">$</span>seasonal</span>
<span id="cb231-4"><a href="time-series-decomposition.html#cb231-4" tabindex="-1"></a>trend.beer <span class="ot">=</span> decomp.beer<span class="sc">$</span>trend</span>
<span id="cb231-5"><a href="time-series-decomposition.html#cb231-5" tabindex="-1"></a>error.beer <span class="ot">=</span> decomp.beer<span class="sc">$</span>random</span></code></pre></div>
<p><strong>Example 9</strong>: Decomposing airline passengers data using <strong>decompose()</strong>.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="time-series-decomposition.html#cb232-1" tabindex="-1"></a>decomp.air <span class="ot">=</span> <span class="fu">decompose</span>(AirPassengers.ts, <span class="st">&quot;multiplicative&quot;</span>)</span>
<span id="cb232-2"><a href="time-series-decomposition.html#cb232-2" tabindex="-1"></a><span class="co"># the four components can be extracted by</span></span>
<span id="cb232-3"><a href="time-series-decomposition.html#cb232-3" tabindex="-1"></a>seasonal.air <span class="ot">=</span> decomp.air<span class="sc">$</span>seasonal</span>
<span id="cb232-4"><a href="time-series-decomposition.html#cb232-4" tabindex="-1"></a>trend.air <span class="ot">=</span> decomp.air<span class="sc">$</span>trend</span>
<span id="cb232-5"><a href="time-series-decomposition.html#cb232-5" tabindex="-1"></a>error.air <span class="ot">=</span> decomp.air<span class="sc">$</span>random</span></code></pre></div>
<p><strong>Concluding Remark</strong>: There are other decomposition methods. among them, <strong>X11</strong> is commonly used in econometrics. The recently developed method <strong>STL()</strong> that used LOESS algorithm to estimate the trend can also be used to extract components from more general time series. We will outline this decomposition method to forecast future values.</p>
</div>
</div>
<div id="forecasting-with-decomposing" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Forecasting with Decomposing<a href="time-series-decomposition.html#forecasting-with-decomposing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Several benchmark forecasting methods were introduced in the previous module. Next, we use these benchmark methods to forecast the deseasonalized series. Since the seasonality of a time series is a <strong>scalar</strong>, we can forecast the deseasonalized series through decomposition and then adjust the forecasted values.</p>
<div id="forecasting-additive-models-with-decomposing" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Forecasting Additive Models with Decomposing<a href="time-series-decomposition.html#forecasting-additive-models-with-decomposing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since the multiplicative models can be converted to an additive model by</p>
<p><span class="math display">\[
\log(y_t) = \log(S_t) + \log(T_t) + \log(E_t).
\]</span></p>
<p>So we only restrict our discussion in this module to additive models. Assuming an additive decomposition, the decomposed time series can be written as</p>
<p><span class="math display">\[y_t = \hat{S}_t + \hat{A}_t\]</span></p>
<p>where <span class="math inline">\(\hat{A}_t = \hat{T} + \hat{E}_t\)</span> is the seasonally adjusted component. We can forecast the future values based on <span class="math inline">\(\hat{A}_t\)</span>.</p>
<p><strong>Example 10</strong>: Forecasting based on the seasonally adjusted series with Australian beer production data. We introduced four benchmark forecasting methods in the previous module. For a time series with a trend, naive, seasonal naive, and drift method is more accurate than the moving average. The issue is that none of the benchmark methods forecast the trend. As an illustrative example, we use the naive method to forecast the deseasonalized series and then add the seasonal adjustment to the forecast values.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="time-series-decomposition.html#cb233-1" tabindex="-1"></a>decomp.beer <span class="ot">=</span> <span class="fu">decompose</span>(ausbeer.ts, <span class="st">&quot;additive&quot;</span>)</span>
<span id="cb233-2"><a href="time-series-decomposition.html#cb233-2" tabindex="-1"></a><span class="co"># the four components can be extracted by</span></span>
<span id="cb233-3"><a href="time-series-decomposition.html#cb233-3" tabindex="-1"></a>seasonal.beer <span class="ot">=</span> decomp.beer<span class="sc">$</span>seasonal</span>
<span id="cb233-4"><a href="time-series-decomposition.html#cb233-4" tabindex="-1"></a>trend.beer <span class="ot">=</span> decomp.beer<span class="sc">$</span>trend</span>
<span id="cb233-5"><a href="time-series-decomposition.html#cb233-5" tabindex="-1"></a>error.beer <span class="ot">=</span> decomp.beer<span class="sc">$</span>random</span>
<span id="cb233-6"><a href="time-series-decomposition.html#cb233-6" tabindex="-1"></a>seasonal.adj <span class="ot">=</span> trend.beer <span class="sc">+</span> error.beer</span>
<span id="cb233-7"><a href="time-series-decomposition.html#cb233-7" tabindex="-1"></a>deseasonalized.pred <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">rwf</span>(<span class="fu">na.omit</span>(seasonal.adj), <span class="at">h =</span> <span class="dv">6</span>)) </span>
<span id="cb233-8"><a href="time-series-decomposition.html#cb233-8" tabindex="-1"></a>seasonality <span class="ot">=</span>  <span class="fu">matrix</span>(<span class="fu">rep</span>(seasonal.beer[<span class="dv">3</span><span class="sc">:</span><span class="dv">8</span>],<span class="dv">5</span>), <span class="at">nco=</span><span class="dv">5</span>, <span class="at">byrow=</span>F)                      </span>
<span id="cb233-9"><a href="time-series-decomposition.html#cb233-9" tabindex="-1"></a>seasonal.adj.pred <span class="ot">&lt;-</span> deseasonalized.pred  <span class="sc">+</span> seasonality</span>
<span id="cb233-10"><a href="time-series-decomposition.html#cb233-10" tabindex="-1"></a><span class="fu">kable</span>(seasonal.adj.pred, <span class="at">caption =</span> <span class="st">&quot;Forecasting with decomposing - drift method&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-210">Table 15.1: </span>Forecasting with decomposing - drift method</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Point Forecast</th>
<th align="right">Lo 80</th>
<th align="right">Hi 80</th>
<th align="right">Lo 95</th>
<th align="right">Hi 95</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1973 Q3</td>
<td align="right">404.7167</td>
<td align="right">386.3725</td>
<td align="right">423.0608</td>
<td align="right">376.6617</td>
<td align="right">432.7717</td>
</tr>
<tr class="even">
<td align="left">1973 Q4</td>
<td align="right">486.6167</td>
<td align="right">460.6741</td>
<td align="right">512.5593</td>
<td align="right">446.9409</td>
<td align="right">526.2924</td>
</tr>
<tr class="odd">
<td align="left">1974 Q1</td>
<td align="right">437.1500</td>
<td align="right">405.3769</td>
<td align="right">468.9231</td>
<td align="right">388.5573</td>
<td align="right">485.7427</td>
</tr>
<tr class="even">
<td align="left">1974 Q2</td>
<td align="right">387.0000</td>
<td align="right">350.3116</td>
<td align="right">423.6884</td>
<td align="right">330.8900</td>
<td align="right">443.1100</td>
</tr>
<tr class="odd">
<td align="left">1974 Q3</td>
<td align="right">404.7167</td>
<td align="right">363.6978</td>
<td align="right">445.7355</td>
<td align="right">341.9838</td>
<td align="right">467.4496</td>
</tr>
<tr class="even">
<td align="left">1974 Q4</td>
<td align="right">486.6167</td>
<td align="right">441.6828</td>
<td align="right">531.5505</td>
<td align="right">417.8962</td>
<td align="right">555.3371</td>
</tr>
</tbody>
</table>
<p>Since the deseasonalized series has two missing values in the beginning and two in the end. we remove the missing values before using the drift methods to forecast the next 6 periods (qtr3, 1973 - qtr 4, 1874). The forecast values are given in the above table.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="time-series-decomposition.html#cb234-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb234-2"><a href="time-series-decomposition.html#cb234-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">62</span>, <span class="fu">as.vector</span>(ausbeer.ts)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">63</span>,<span class="dv">64</span>)], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">70</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">200</span>, <span class="dv">570</span>),</span>
<span id="cb234-3"><a href="time-series-decomposition.html#cb234-3" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Beer Production&quot;</span>, <span class="at">main=</span><span class="st">&quot;Forecast with classical decomposing&quot;</span>)</span>
<span id="cb234-4"><a href="time-series-decomposition.html#cb234-4" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">62</span><span class="sc">:</span><span class="dv">64</span>,  <span class="fu">as.vector</span>(ausbeer.ts)[<span class="fu">c</span>(<span class="dv">62</span>,<span class="dv">63</span>,<span class="dv">64</span>)], <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb234-5"><a href="time-series-decomposition.html#cb234-5" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">62</span><span class="sc">:</span><span class="dv">64</span>,  <span class="fu">as.vector</span>(ausbeer.ts)[<span class="fu">c</span>(<span class="dv">62</span>,<span class="dv">63</span>,<span class="dv">64</span>)], <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">21</span>)</span>
<span id="cb234-6"><a href="time-series-decomposition.html#cb234-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">63</span><span class="sc">:</span><span class="dv">68</span>,seasonal.adj.pred[,<span class="dv">1</span>], <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb234-7"><a href="time-series-decomposition.html#cb234-7" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">63</span><span class="sc">:</span><span class="dv">68</span>,seasonal.adj.pred[,<span class="dv">1</span>], <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-211"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-211-1.png" alt="forecasting with classical decomposing" width="576" />
<p class="caption">
Figure 15.8: forecasting with classical decomposing
</p>
</div>
<p>The plot of the forecast values and the original values. The red plot represented quarters 3-4 of 1973 and forecast values in quarters 3 - quarters 4, 1974, are plotted in <strong>blue</strong>. We can see that</p>
</div>
<div id="concepts-of-seasonal-and-trend-decomposition-using-loess-stl" class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> Concepts of Seasonal and Trend Decomposition Using Loess (STL)<a href="time-series-decomposition.html#concepts-of-seasonal-and-trend-decomposition-using-loess-stl" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Seasonal and Trend decomposition using LOESS (STL) combines the classical time series decomposition and the <strong>modern</strong> locally estimated scatterplot smoothing (LOESS). The LOESS has developed about 40 years ago and is a modern computational algorithm. The seasonal trend in a time series is a <strong>fixed</strong> pattern. The real benefit of STL is to use the LOESS to estimate the nonlinear trend more accurately. We will not discuss the technical development of the STL. Instead, we will use its R implementation to decompose time series and use it to forecast future values.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="time-series-decomposition.html#cb235-1" tabindex="-1"></a>stl.beer <span class="ot">=</span> <span class="fu">stl</span>(ausbeer.ts, <span class="st">&quot;periodic&quot;</span>)</span>
<span id="cb235-2"><a href="time-series-decomposition.html#cb235-2" tabindex="-1"></a>seasonal.stl.beer   <span class="ot">&lt;-</span> stl.beer<span class="sc">$</span>time.series[,<span class="dv">1</span>]</span>
<span id="cb235-3"><a href="time-series-decomposition.html#cb235-3" tabindex="-1"></a>trend.stl.beer     <span class="ot">&lt;-</span> stl.beer<span class="sc">$</span>time.series[,<span class="dv">2</span>]</span>
<span id="cb235-4"><a href="time-series-decomposition.html#cb235-4" tabindex="-1"></a>random.stl.beer  <span class="ot">&lt;-</span> stl.beer<span class="sc">$</span>time.series[,<span class="dv">3</span>]</span>
<span id="cb235-5"><a href="time-series-decomposition.html#cb235-5" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb235-6"><a href="time-series-decomposition.html#cb235-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">1</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb235-7"><a href="time-series-decomposition.html#cb235-7" tabindex="-1"></a><span class="fu">plot</span>(ausbeer.ts)</span>
<span id="cb235-8"><a href="time-series-decomposition.html#cb235-8" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">as.ts</span>(seasonal.stl.beer))</span>
<span id="cb235-9"><a href="time-series-decomposition.html#cb235-9" tabindex="-1"></a><span class="fu">plot</span>(trend.stl.beer)</span>
<span id="cb235-10"><a href="time-series-decomposition.html#cb235-10" tabindex="-1"></a><span class="fu">plot</span>(random.stl.beer)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-212"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-212-1.png" alt="Decomposing with STL approach" width="480" />
<p class="caption">
Figure 15.9: Decomposing with STL approach
</p>
</div>
<p>We can also plot the above-decomposed components in a single step as follows with the STL model.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="time-series-decomposition.html#cb236-1" tabindex="-1"></a><span class="fu">plot</span>(stl.beer)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-213"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-213-1.png" alt="plot component panel with STL object" width="480" />
<p class="caption">
Figure 15.10: plot component panel with STL object
</p>
</div>
</div>
<div id="forecast-with-stl-decomposing" class="section level3 hasAnchor" number="15.3.3">
<h3><span class="header-section-number">15.3.3</span> Forecast with STL decomposing<a href="time-series-decomposition.html#forecast-with-stl-decomposing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the additive model, we can use the R function <strong>stl()</strong> to decompose the series into three components. It uses a more robust non-parametric smoothing method (LOESS) to estimate the nonlinear trend.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="time-series-decomposition.html#cb237-1" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">stl</span>(ausbeer.ts,<span class="at">s.window=</span><span class="st">&quot;periodic&quot;</span>)</span>
<span id="cb237-2"><a href="time-series-decomposition.html#cb237-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb237-3"><a href="time-series-decomposition.html#cb237-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(fit,<span class="at">h=</span><span class="dv">6</span>, <span class="at">method=</span><span class="st">&quot;rwdrift&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-214"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-214-1.png" alt="Forecas with STL decomposing" width="480" />
<p class="caption">
Figure 15.11: Forecas with STL decomposing
</p>
</div>
</div>
<div id="length-of-time-series" class="section level3 hasAnchor" number="15.3.4">
<h3><span class="header-section-number">15.3.4</span> Length of Time Series<a href="time-series-decomposition.html#length-of-time-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The length of the time series impacts the performance of the forecasting. In general, a very long time series (for example, more than 200 observations) usually does not work well for most of the existing models partly because the existing models were not built for <strong>very long</strong> series. Intuitively, future values are dependent on recent historical values. If including too old observations that have no predictive power in the model will bring bias and noise to the underlying model and, hence, negative impacts on the performance of the model.</p>
<p>There are a lot of discussions in literature and practice about the minimum size required for building a good time series model. It seems that 60 is the suggested minimum size. The actual minimum size depends on the situation and the level of accuracy.</p>
<p>In this class, we recommend the sample size be between 60 and 200. Therefore, in the assignment, if the original time series data has more than 200 observations, we can use only 150-200 most recent data values for analysis.</p>
</div>
</div>
<div id="case-study-2" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Case Study<a href="time-series-decomposition.html#case-study-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="data-description-and" class="section level3 hasAnchor" number="15.4.1">
<h3><span class="header-section-number">15.4.1</span> Data description and<a href="time-series-decomposition.html#data-description-and" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The time series used in this case study is chosen from <a href="https://datahub.io/search">https://datahub.io/search</a>: 10-year nominal yields on US government bonds from the Federal Reserve. The 10-year government bond yield is considered a standard indicator of long-term interest rates. The data contains monthly rates. There are 808 months of data between April 1943 and July 2020. We only use look at monthly data between January 2008 and July 2020.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="time-series-decomposition.html#cb238-1" tabindex="-1"></a>us.bond<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">&quot;https://datahub.io/core/bond-yields-us-10y/r/monthly.csv&quot;</span>)</span>
<span id="cb238-2"><a href="time-series-decomposition.html#cb238-2" tabindex="-1"></a>n.row <span class="ot">=</span> <span class="fu">dim</span>(us.bond)[<span class="dv">1</span>]</span>
<span id="cb238-3"><a href="time-series-decomposition.html#cb238-3" tabindex="-1"></a>data.us.bond <span class="ot">=</span> us.bond[(n.row<span class="dv">-150</span>)<span class="sc">:</span>n.row, ]</span></code></pre></div>
</div>
<div id="define-time-series-object" class="section level3 hasAnchor" number="15.4.2">
<h3><span class="header-section-number">15.4.2</span> Define time series object<a href="time-series-decomposition.html#define-time-series-object" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since this is monthly data, frequency =12 will be used the define the time series object.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="time-series-decomposition.html#cb239-1" tabindex="-1"></a>usbond.ts <span class="ot">=</span> <span class="fu">ts</span>(data.us.bond[,<span class="dv">2</span>], <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">1</span>))</span>
<span id="cb239-2"><a href="time-series-decomposition.html#cb239-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb239-3"><a href="time-series-decomposition.html#cb239-3" tabindex="-1"></a><span class="fu">plot</span>(usbond.ts, <span class="at">main=</span><span class="st">&quot;US Bond Rates Between Jan, 2008 and July, 2020&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Monthly Rate&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-216"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-216-1.png" alt="US bond monthly rates" width="480" />
<p class="caption">
Figure 15.12: US bond monthly rates
</p>
</div>
</div>
<div id="forecasting-with-decomposing-1" class="section level3 hasAnchor" number="15.4.3">
<h3><span class="header-section-number">15.4.3</span> Forecasting with Decomposing<a href="time-series-decomposition.html#forecasting-with-decomposing-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Notice that the classical decomposition method does not work as well as the STL method due to the robustness of the LOESS component. The following visual representations show the different behaviors of the two methods of decomposition.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="time-series-decomposition.html#cb240-1" tabindex="-1"></a>cls.decomp <span class="ot">=</span> <span class="fu">decompose</span>(usbond.ts)</span>
<span id="cb240-2"><a href="time-series-decomposition.html#cb240-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb240-3"><a href="time-series-decomposition.html#cb240-3" tabindex="-1"></a><span class="fu">plot</span>(cls.decomp, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-217"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-217-1.png" alt="Classical decomposition of additive time series" width="576" />
<p class="caption">
Figure 15.13: Classical decomposition of additive time series
</p>
</div>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="time-series-decomposition.html#cb241-1" tabindex="-1"></a>stl.decomp<span class="ot">=</span><span class="fu">stl</span>(usbond.ts, <span class="at">s.window =</span> <span class="dv">12</span>)</span>
<span id="cb241-2"><a href="time-series-decomposition.html#cb241-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb241-3"><a href="time-series-decomposition.html#cb241-3" tabindex="-1"></a><span class="fu">plot</span>(stl.decomp)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-218"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-218-1.png" alt="STL decomposition of additive time series" width="672" />
<p class="caption">
Figure 15.14: STL decomposition of additive time series
</p>
</div>
<p><strong>Training and Testing Data</strong></p>
<p>We hold up the <strong>last 7 periods</strong> of data for testing. The rest of the historical data will be used to train the forecast model.</p>
<p>To evaluate the effect of different sizes in training the time series, We define different training data sets with different sizes. Three training set sizes used in this example are 144, 109, 73, and 48. The same test set with size 7 will be used to calculate the prediction error.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="time-series-decomposition.html#cb242-1" tabindex="-1"></a>ini.data <span class="ot">=</span> data.us.bond[,<span class="dv">2</span>]</span>
<span id="cb242-2"><a href="time-series-decomposition.html#cb242-2" tabindex="-1"></a>n0 <span class="ot">=</span> <span class="fu">length</span>(ini.data)</span>
<span id="cb242-3"><a href="time-series-decomposition.html#cb242-3" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb242-4"><a href="time-series-decomposition.html#cb242-4" tabindex="-1"></a>train.data01 <span class="ot">=</span> data.us.bond[<span class="dv">1</span><span class="sc">:</span>(n0<span class="dv">-7</span>), <span class="dv">2</span>]</span>
<span id="cb242-5"><a href="time-series-decomposition.html#cb242-5" tabindex="-1"></a>train.data02 <span class="ot">=</span> data.us.bond[<span class="dv">37</span><span class="sc">:</span>(n0<span class="dv">-7</span>), <span class="dv">2</span>]</span>
<span id="cb242-6"><a href="time-series-decomposition.html#cb242-6" tabindex="-1"></a>train.data03 <span class="ot">=</span> data.us.bond[<span class="dv">73</span><span class="sc">:</span>(n0<span class="dv">-7</span>), <span class="dv">2</span>]</span>
<span id="cb242-7"><a href="time-series-decomposition.html#cb242-7" tabindex="-1"></a>train.data04 <span class="ot">=</span> data.us.bond[<span class="dv">97</span><span class="sc">:</span>(n0<span class="dv">-7</span>), <span class="dv">2</span>]</span>
<span id="cb242-8"><a href="time-series-decomposition.html#cb242-8" tabindex="-1"></a><span class="do">## last 7 observations</span></span>
<span id="cb242-9"><a href="time-series-decomposition.html#cb242-9" tabindex="-1"></a>test.data <span class="ot">=</span> data.us.bond[(n0<span class="dv">-6</span>)<span class="sc">:</span>n0,<span class="dv">2</span>]</span>
<span id="cb242-10"><a href="time-series-decomposition.html#cb242-10" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb242-11"><a href="time-series-decomposition.html#cb242-11" tabindex="-1"></a>train01.ts <span class="ot">=</span> <span class="fu">ts</span>(train.data01, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2008</span>, <span class="dv">1</span>))</span>
<span id="cb242-12"><a href="time-series-decomposition.html#cb242-12" tabindex="-1"></a>train02.ts <span class="ot">=</span> <span class="fu">ts</span>(train.data02, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2011</span>, <span class="dv">1</span>))</span>
<span id="cb242-13"><a href="time-series-decomposition.html#cb242-13" tabindex="-1"></a>train03.ts <span class="ot">=</span> <span class="fu">ts</span>(train.data03, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2014</span>, <span class="dv">1</span>))</span>
<span id="cb242-14"><a href="time-series-decomposition.html#cb242-14" tabindex="-1"></a>train04.ts <span class="ot">=</span> <span class="fu">ts</span>(train.data04, <span class="at">frequency =</span> <span class="dv">12</span>, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2016</span>, <span class="dv">1</span>))</span>
<span id="cb242-15"><a href="time-series-decomposition.html#cb242-15" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb242-16"><a href="time-series-decomposition.html#cb242-16" tabindex="-1"></a>stl01 <span class="ot">=</span> <span class="fu">stl</span>(train01.ts, <span class="at">s.window =</span> <span class="dv">12</span>)</span>
<span id="cb242-17"><a href="time-series-decomposition.html#cb242-17" tabindex="-1"></a>stl02 <span class="ot">=</span> <span class="fu">stl</span>(train02.ts, <span class="at">s.window =</span> <span class="dv">12</span>)</span>
<span id="cb242-18"><a href="time-series-decomposition.html#cb242-18" tabindex="-1"></a>stl03 <span class="ot">=</span> <span class="fu">stl</span>(train03.ts, <span class="at">s.window =</span> <span class="dv">12</span>)</span>
<span id="cb242-19"><a href="time-series-decomposition.html#cb242-19" tabindex="-1"></a>stl04 <span class="ot">=</span> <span class="fu">stl</span>(train04.ts, <span class="at">s.window =</span> <span class="dv">12</span>)</span>
<span id="cb242-20"><a href="time-series-decomposition.html#cb242-20" tabindex="-1"></a><span class="do">## Forecast with decomposing</span></span>
<span id="cb242-21"><a href="time-series-decomposition.html#cb242-21" tabindex="-1"></a>fcst01 <span class="ot">=</span> <span class="fu">forecast</span>(stl01,<span class="at">h=</span><span class="dv">7</span>, <span class="at">method=</span><span class="st">&quot;naive&quot;</span>)</span>
<span id="cb242-22"><a href="time-series-decomposition.html#cb242-22" tabindex="-1"></a>fcst02 <span class="ot">=</span> <span class="fu">forecast</span>(stl02,<span class="at">h=</span><span class="dv">7</span>, <span class="at">method=</span><span class="st">&quot;naive&quot;</span>)</span>
<span id="cb242-23"><a href="time-series-decomposition.html#cb242-23" tabindex="-1"></a>fcst03 <span class="ot">=</span> <span class="fu">forecast</span>(stl03,<span class="at">h=</span><span class="dv">7</span>, <span class="at">method=</span><span class="st">&quot;naive&quot;</span>)</span>
<span id="cb242-24"><a href="time-series-decomposition.html#cb242-24" tabindex="-1"></a>fcst04 <span class="ot">=</span> <span class="fu">forecast</span>(stl04,<span class="at">h=</span><span class="dv">7</span>, <span class="at">method=</span><span class="st">&quot;naive&quot;</span>)</span></code></pre></div>
<p>We next perform error analysis.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="time-series-decomposition.html#cb243-1" tabindex="-1"></a><span class="do">## To compare different errors, we will not use the percentage for MAPE</span></span>
<span id="cb243-2"><a href="time-series-decomposition.html#cb243-2" tabindex="-1"></a>PE01<span class="ot">=</span>(test.data<span class="sc">-</span>fcst01<span class="sc">$</span>mean)<span class="sc">/</span>fcst01<span class="sc">$</span>mean</span>
<span id="cb243-3"><a href="time-series-decomposition.html#cb243-3" tabindex="-1"></a>PE02<span class="ot">=</span>(test.data<span class="sc">-</span>fcst02<span class="sc">$</span>mean)<span class="sc">/</span>fcst02<span class="sc">$</span>mean</span>
<span id="cb243-4"><a href="time-series-decomposition.html#cb243-4" tabindex="-1"></a>PE03<span class="ot">=</span>(test.data<span class="sc">-</span>fcst03<span class="sc">$</span>mean)<span class="sc">/</span>fcst03<span class="sc">$</span>mean</span>
<span id="cb243-5"><a href="time-series-decomposition.html#cb243-5" tabindex="-1"></a>PE04<span class="ot">=</span>(test.data<span class="sc">-</span>fcst04<span class="sc">$</span>mean)<span class="sc">/</span>fcst04<span class="sc">$</span>mean</span>
<span id="cb243-6"><a href="time-series-decomposition.html#cb243-6" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb243-7"><a href="time-series-decomposition.html#cb243-7" tabindex="-1"></a>MAPE1 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(PE01))</span>
<span id="cb243-8"><a href="time-series-decomposition.html#cb243-8" tabindex="-1"></a>MAPE2 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(PE02))</span>
<span id="cb243-9"><a href="time-series-decomposition.html#cb243-9" tabindex="-1"></a>MAPE3 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(PE03))</span>
<span id="cb243-10"><a href="time-series-decomposition.html#cb243-10" tabindex="-1"></a>MAPE4 <span class="ot">=</span> <span class="fu">mean</span>(<span class="fu">abs</span>(PE04))</span>
<span id="cb243-11"><a href="time-series-decomposition.html#cb243-11" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb243-12"><a href="time-series-decomposition.html#cb243-12" tabindex="-1"></a>E1<span class="ot">=</span>test.data<span class="sc">-</span>fcst01<span class="sc">$</span>mean</span>
<span id="cb243-13"><a href="time-series-decomposition.html#cb243-13" tabindex="-1"></a>E2<span class="ot">=</span>test.data<span class="sc">-</span>fcst02<span class="sc">$</span>mean</span>
<span id="cb243-14"><a href="time-series-decomposition.html#cb243-14" tabindex="-1"></a>E3<span class="ot">=</span>test.data<span class="sc">-</span>fcst03<span class="sc">$</span>mean</span>
<span id="cb243-15"><a href="time-series-decomposition.html#cb243-15" tabindex="-1"></a>E4<span class="ot">=</span>test.data<span class="sc">-</span>fcst04<span class="sc">$</span>mean</span>
<span id="cb243-16"><a href="time-series-decomposition.html#cb243-16" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb243-17"><a href="time-series-decomposition.html#cb243-17" tabindex="-1"></a>MSE1<span class="ot">=</span><span class="fu">mean</span>(E1<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb243-18"><a href="time-series-decomposition.html#cb243-18" tabindex="-1"></a>MSE2<span class="ot">=</span><span class="fu">mean</span>(E2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb243-19"><a href="time-series-decomposition.html#cb243-19" tabindex="-1"></a>MSE3<span class="ot">=</span><span class="fu">mean</span>(E3<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb243-20"><a href="time-series-decomposition.html#cb243-20" tabindex="-1"></a>MSE4<span class="ot">=</span><span class="fu">mean</span>(E4<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb243-21"><a href="time-series-decomposition.html#cb243-21" tabindex="-1"></a><span class="do">###</span></span>
<span id="cb243-22"><a href="time-series-decomposition.html#cb243-22" tabindex="-1"></a>MSE<span class="ot">=</span><span class="fu">c</span>(MSE1, MSE2, MSE3, MSE4)</span>
<span id="cb243-23"><a href="time-series-decomposition.html#cb243-23" tabindex="-1"></a>MAPE<span class="ot">=</span><span class="fu">c</span>(MAPE1, MAPE2, MAPE3, MAPE4)</span>
<span id="cb243-24"><a href="time-series-decomposition.html#cb243-24" tabindex="-1"></a>accuracy<span class="ot">=</span><span class="fu">cbind</span>(<span class="at">MSE=</span>MSE, <span class="at">MAPE=</span>MAPE)</span>
<span id="cb243-25"><a href="time-series-decomposition.html#cb243-25" tabindex="-1"></a><span class="fu">row.names</span>(accuracy)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;n.144&quot;</span>, <span class="st">&quot;n.109&quot;</span>, <span class="st">&quot;n. 73&quot;</span>, <span class="st">&quot;n. 48&quot;</span>)</span>
<span id="cb243-26"><a href="time-series-decomposition.html#cb243-26" tabindex="-1"></a><span class="fu">kable</span>(accuracy, <span class="at">caption=</span><span class="st">&quot;Error comparison between forecast results with different sample sizes&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-220">Table 15.2: </span>Error comparison between forecast results with different sample sizes</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">MSE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n.144</td>
<td align="right">0.7967685</td>
<td align="right">0.4518108</td>
</tr>
<tr class="even">
<td align="left">n.109</td>
<td align="right">0.7718715</td>
<td align="right">0.4463052</td>
</tr>
<tr class="odd">
<td align="left">n. 73</td>
<td align="right">0.7665760</td>
<td align="right">0.4449924</td>
</tr>
<tr class="even">
<td align="left">n. 48</td>
<td align="right">0.8055530</td>
<td align="right">0.4649921</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="time-series-decomposition.html#cb244-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, MSE, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Error&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb244-2"><a href="time-series-decomposition.html#cb244-2" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.4</span>,.<span class="dv">85</span>),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">4.5</span>), <span class="at">main=</span><span class="st">&quot;Error Curves&quot;</span>, <span class="at">axes=</span><span class="cn">FALSE</span>)</span>
<span id="cb244-3"><a href="time-series-decomposition.html#cb244-3" tabindex="-1"></a>labs<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;n=144&quot;</span>, <span class="st">&quot;n=109&quot;</span>, <span class="st">&quot;n=73&quot;</span>, <span class="st">&quot;n=48&quot;</span>)</span>
<span id="cb244-4"><a href="time-series-decomposition.html#cb244-4" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">label=</span>labs, <span class="at">pos=</span><span class="fl">0.4</span>)</span>
<span id="cb244-5"><a href="time-series-decomposition.html#cb244-5" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span>
<span id="cb244-6"><a href="time-series-decomposition.html#cb244-6" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, MAPE, <span class="at">type=</span><span class="st">&quot;b&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb244-7"><a href="time-series-decomposition.html#cb244-7" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, MAPE<span class="fl">+0.03</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(MAPE,<span class="dv">4</span>)), <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb244-8"><a href="time-series-decomposition.html#cb244-8" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, MSE<span class="fl">-0.03</span>, <span class="fu">as.character</span>(<span class="fu">round</span>(MSE,<span class="dv">4</span>)), <span class="at">col=</span><span class="st">&quot;darkred&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>)</span>
<span id="cb244-9"><a href="time-series-decomposition.html#cb244-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">1.5</span>, <span class="fl">0.63</span>, <span class="fu">c</span>(<span class="st">&quot;MSE&quot;</span>, <span class="st">&quot;MAPE&quot;</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;darkred&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">bty=</span><span class="st">&quot;n&quot;</span>, <span class="at">cex=</span><span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-221"></span>
<img src="STA321EB_files/figure-html/unnamed-chunk-221-1.png" alt="Comparing forecast errors" width="480" />
<p class="caption">
Figure 15.15: Comparing forecast errors
</p>
</div>
<p>We trained the same algorithm with different sample sizes and compared the resulting accuracy measures. Among four training sizes 144, 109, 73, and 48. training data size 73 yields the best performance.</p>
<p>As anticipated, forecasting with STL smoothing does not yield decent results. However, our case study still accomplishes the main learning goals. To be more specific, we have learned how to</p>
<ul>
<li><p>decompose a time series</p></li>
<li><p>distinguish the graphical patterns of additive and multiplicative time series models</p></li>
<li><p>use the non-parametric smoothing LOESS method in time series forecasting;</p></li>
<li><p>use the technique of machine learning to tune the training size to identify the optimal training size to achieve the best accuracy. In this case, the training size is considered a tuning parameter (hyper-parameter).</p></li>
</ul>
<p>We will start building actual and practical forecasting models in the next module - exponential smoothing models.</p>
</div>
</div>
<div id="analysis-assignment-6" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> Analysis Assignment<a href="time-series-decomposition.html#analysis-assignment-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This assignment focuses on the conceptual understanding of decomposing time series and forecasting with decomposing. As mentioned in the closing paragraph of the case study in the class note, the goals of this assignment are (1) to enhance your conceptual understanding of methods of decomposition and forecasting; (2) to find the appropriate training size to produce the best performance.</p>
<p>The following websites contain some time series data. You can find one time series that has at least 150 observations. If your data set has more than 150, you choose 150-200 most recent observations to complete the assignment. The analysis and components in the analysis should be similar to that in the case study in the class note.</p>
<ol style="list-style-type: decimal">
<li><p><a href="https://www.census.gov/econ/currentdata/datasets/index" class="uri">https://www.census.gov/econ/currentdata/datasets/index</a></p></li>
<li><p><a href="https://datahub.io/search" class="uri">https://datahub.io/search</a></p></li>
<li><p><a href="https://lionbridge.ai/datasets/17-best-finance-economic-datasets-for-machine-learning/" class="uri">https://lionbridge.ai/datasets/17-best-finance-economic-datasets-for-machine-learning/</a></p></li>
</ol>
<p>You can also find your data set from other sites for this assignment.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="concepts-of-time-series-forecasting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exponential-smoothing-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/pengdsci/STA321EB/edit/master/14-TimeSeriesDecomposition.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["STA321EB.pdf", "STA321EB.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
